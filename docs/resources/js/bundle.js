//     Underscore.js 1.8.3
//     http://underscorejs.org
//     (c) 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

// ko.svgTemplateEngine.js v0.0.2
// Author: Robat Williams - github.com/robatwilliams
// SVG parsing technique from https://github.com/GilesBradshaw/Knockout.js-Observable-Template-Engine/ by Giles Bradshaw
// License: MIT (http://www.opensource.org/licenses/mit-license.php)

/*!
 * jQuery Mousewheel 3.1.13
 *
 * Copyright 2015 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

(function(){function e(e){function t(t,n,i,r,o,a){for(;o>=0&&a>o;o+=e){var s=r?r[o]:o;i=n(i,t[s],s,t)}return i}return function(n,i,r,o){i=y(i,o,4);var a=!C(n)&&b.keys(n),s=(a||n).length,u=e>0?0:s-1;return arguments.length<3&&(r=n[a?a[u]:u],u+=e),t(n,i,r,a,u,s)}}function t(e){return function(t,n,i){n=_(n,i);for(var r=D(t),o=e>0?0:r-1;o>=0&&r>o;o+=e)if(n(t[o],o,t))return o;return-1}}function n(e,t,n){return function(i,r,o){var a=0,s=D(i);if("number"==typeof o)e>0?a=o>=0?o:Math.max(o+s,a):s=o>=0?Math.min(o+1,s):o+s+1;else if(n&&o&&s)return o=n(i,r),i[o]===r?o:-1;if(r!==r)return o=t(c.call(i,a,s),b.isNaN),o>=0?o+a:-1;for(o=e>0?a:s-1;o>=0&&s>o;o+=e)if(i[o]===r)return o;return-1}}function i(e,t){var n=N.length,i=e.constructor,r=b.isFunction(i)&&i.prototype||s,o="constructor";for(b.has(e,o)&&!b.contains(t,o)&&t.push(o);n--;)o=N[n],o in e&&e[o]!==r[o]&&!b.contains(t,o)&&t.push(o)}var r=this,o=r._,a=Array.prototype,s=Object.prototype,u=Function.prototype,l=a.push,c=a.slice,d=s.toString,f=s.hasOwnProperty,p=Array.isArray,h=Object.keys,g=u.bind,m=Object.create,v=function(){},b=function(e){return e instanceof b?e:this instanceof b?void(this._wrapped=e):new b(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=b),exports._=b):r._=b,b.VERSION="1.8.3";var y=function(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)};case 4:return function(n,i,r,o){return e.call(t,n,i,r,o)}}return function(){return e.apply(t,arguments)}},_=function(e,t,n){return null==e?b.identity:b.isFunction(e)?y(e,t,n):b.isObject(e)?b.matcher(e):b.property(e)};b.iteratee=function(e,t){return _(e,t,1/0)};var M=function(e,t){return function(n){var i=arguments.length;if(2>i||null==n)return n;for(var r=1;i>r;r++)for(var o=arguments[r],a=e(o),s=a.length,u=0;s>u;u++){var l=a[u];t&&void 0!==n[l]||(n[l]=o[l])}return n}},x=function(e){if(!b.isObject(e))return{};if(m)return m(e);v.prototype=e;var t=new v;return v.prototype=null,t},E=function(e){return function(t){return null==t?void 0:t[e]}},A=Math.pow(2,53)-1,D=E("length"),C=function(e){var t=D(e);return"number"==typeof t&&t>=0&&A>=t};b.each=b.forEach=function(e,t,n){t=y(t,n);var i,r;if(C(e))for(i=0,r=e.length;r>i;i++)t(e[i],i,e);else{var o=b.keys(e);for(i=0,r=o.length;r>i;i++)t(e[o[i]],o[i],e)}return e},b.map=b.collect=function(e,t,n){t=_(t,n);for(var i=!C(e)&&b.keys(e),r=(i||e).length,o=Array(r),a=0;r>a;a++){var s=i?i[a]:a;o[a]=t(e[s],s,e)}return o},b.reduce=b.foldl=b.inject=e(1),b.reduceRight=b.foldr=e(-1),b.find=b.detect=function(e,t,n){var i;return i=C(e)?b.findIndex(e,t,n):b.findKey(e,t,n),void 0!==i&&i!==-1?e[i]:void 0},b.filter=b.select=function(e,t,n){var i=[];return t=_(t,n),b.each(e,function(e,n,r){t(e,n,r)&&i.push(e)}),i},b.reject=function(e,t,n){return b.filter(e,b.negate(_(t)),n)},b.every=b.all=function(e,t,n){t=_(t,n);for(var i=!C(e)&&b.keys(e),r=(i||e).length,o=0;r>o;o++){var a=i?i[o]:o;if(!t(e[a],a,e))return!1}return!0},b.some=b.any=function(e,t,n){t=_(t,n);for(var i=!C(e)&&b.keys(e),r=(i||e).length,o=0;r>o;o++){var a=i?i[o]:o;if(t(e[a],a,e))return!0}return!1},b.contains=b.includes=b.include=function(e,t,n,i){return C(e)||(e=b.values(e)),("number"!=typeof n||i)&&(n=0),b.indexOf(e,t,n)>=0},b.invoke=function(e,t){var n=c.call(arguments,2),i=b.isFunction(t);return b.map(e,function(e){var r=i?t:e[t];return null==r?r:r.apply(e,n)})},b.pluck=function(e,t){return b.map(e,b.property(t))},b.where=function(e,t){return b.filter(e,b.matcher(t))},b.findWhere=function(e,t){return b.find(e,b.matcher(t))},b.max=function(e,t,n){var i,r,o=-1/0,a=-1/0;if(null==t&&null!=e){e=C(e)?e:b.values(e);for(var s=0,u=e.length;u>s;s++)i=e[s],i>o&&(o=i)}else t=_(t,n),b.each(e,function(e,n,i){r=t(e,n,i),(r>a||r===-1/0&&o===-1/0)&&(o=e,a=r)});return o},b.min=function(e,t,n){var i,r,o=1/0,a=1/0;if(null==t&&null!=e){e=C(e)?e:b.values(e);for(var s=0,u=e.length;u>s;s++)i=e[s],o>i&&(o=i)}else t=_(t,n),b.each(e,function(e,n,i){r=t(e,n,i),(a>r||1/0===r&&1/0===o)&&(o=e,a=r)});return o},b.shuffle=function(e){for(var t,n=C(e)?e:b.values(e),i=n.length,r=Array(i),o=0;i>o;o++)t=b.random(0,o),t!==o&&(r[o]=r[t]),r[t]=n[o];return r},b.sample=function(e,t,n){return null==t||n?(C(e)||(e=b.values(e)),e[b.random(e.length-1)]):b.shuffle(e).slice(0,Math.max(0,t))},b.sortBy=function(e,t,n){return t=_(t,n),b.pluck(b.map(e,function(e,n,i){return{value:e,index:n,criteria:t(e,n,i)}}).sort(function(e,t){var n=e.criteria,i=t.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return e.index-t.index}),"value")};var O=function(e){return function(t,n,i){var r={};return n=_(n,i),b.each(t,function(i,o){var a=n(i,o,t);e(r,i,a)}),r}};b.groupBy=O(function(e,t,n){b.has(e,n)?e[n].push(t):e[n]=[t]}),b.indexBy=O(function(e,t,n){e[n]=t}),b.countBy=O(function(e,t,n){b.has(e,n)?e[n]++:e[n]=1}),b.toArray=function(e){return e?b.isArray(e)?c.call(e):C(e)?b.map(e,b.identity):b.values(e):[]},b.size=function(e){return null==e?0:C(e)?e.length:b.keys(e).length},b.partition=function(e,t,n){t=_(t,n);var i=[],r=[];return b.each(e,function(e,n,o){(t(e,n,o)?i:r).push(e)}),[i,r]},b.first=b.head=b.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:b.initial(e,e.length-t)},b.initial=function(e,t,n){return c.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))},b.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:b.rest(e,Math.max(0,e.length-t))},b.rest=b.tail=b.drop=function(e,t,n){return c.call(e,null==t||n?1:t)},b.compact=function(e){return b.filter(e,b.identity)};var w=function(e,t,n,i){for(var r=[],o=0,a=i||0,s=D(e);s>a;a++){var u=e[a];if(C(u)&&(b.isArray(u)||b.isArguments(u))){t||(u=w(u,t,n));var l=0,c=u.length;for(r.length+=c;c>l;)r[o++]=u[l++]}else n||(r[o++]=u)}return r};b.flatten=function(e,t){return w(e,t,!1)},b.without=function(e){return b.difference(e,c.call(arguments,1))},b.uniq=b.unique=function(e,t,n,i){b.isBoolean(t)||(i=n,n=t,t=!1),null!=n&&(n=_(n,i));for(var r=[],o=[],a=0,s=D(e);s>a;a++){var u=e[a],l=n?n(u,a,e):u;t?(a&&o===l||r.push(u),o=l):n?b.contains(o,l)||(o.push(l),r.push(u)):b.contains(r,u)||r.push(u)}return r},b.union=function(){return b.uniq(w(arguments,!0,!0))},b.intersection=function(e){for(var t=[],n=arguments.length,i=0,r=D(e);r>i;i++){var o=e[i];if(!b.contains(t,o)){for(var a=1;n>a&&b.contains(arguments[a],o);a++);a===n&&t.push(o)}}return t},b.difference=function(e){var t=w(arguments,!0,!0,1);return b.filter(e,function(e){return!b.contains(t,e)})},b.zip=function(){return b.unzip(arguments)},b.unzip=function(e){for(var t=e&&b.max(e,D).length||0,n=Array(t),i=0;t>i;i++)n[i]=b.pluck(e,i);return n},b.object=function(e,t){for(var n={},i=0,r=D(e);r>i;i++)t?n[e[i]]=t[i]:n[e[i][0]]=e[i][1];return n},b.findIndex=t(1),b.findLastIndex=t(-1),b.sortedIndex=function(e,t,n,i){n=_(n,i,1);for(var r=n(t),o=0,a=D(e);a>o;){var s=Math.floor((o+a)/2);n(e[s])<r?o=s+1:a=s}return o},b.indexOf=n(1,b.findIndex,b.sortedIndex),b.lastIndexOf=n(-1,b.findLastIndex),b.range=function(e,t,n){null==t&&(t=e||0,e=0),n=n||1;for(var i=Math.max(Math.ceil((t-e)/n),0),r=Array(i),o=0;i>o;o++,e+=n)r[o]=e;return r};var S=function(e,t,n,i,r){if(!(i instanceof t))return e.apply(n,r);var o=x(e.prototype),a=e.apply(o,r);return b.isObject(a)?a:o};b.bind=function(e,t){if(g&&e.bind===g)return g.apply(e,c.call(arguments,1));if(!b.isFunction(e))throw new TypeError("Bind must be called on a function");var n=c.call(arguments,2),i=function(){return S(e,i,t,this,n.concat(c.call(arguments)))};return i},b.partial=function(e){var t=c.call(arguments,1),n=function(){for(var i=0,r=t.length,o=Array(r),a=0;r>a;a++)o[a]=t[a]===b?arguments[i++]:t[a];for(;i<arguments.length;)o.push(arguments[i++]);return S(e,n,this,this,o)};return n},b.bindAll=function(e){var t,n,i=arguments.length;if(1>=i)throw new Error("bindAll must be passed function names");for(t=1;i>t;t++)n=arguments[t],e[n]=b.bind(e[n],e);return e},b.memoize=function(e,t){var n=function(i){var r=n.cache,o=""+(t?t.apply(this,arguments):i);return b.has(r,o)||(r[o]=e.apply(this,arguments)),r[o]};return n.cache={},n},b.delay=function(e,t){var n=c.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},b.defer=b.partial(b.delay,b,1),b.throttle=function(e,t,n){var i,r,o,a=null,s=0;n||(n={});var u=function(){s=n.leading===!1?0:b.now(),a=null,o=e.apply(i,r),a||(i=r=null)};return function(){var l=b.now();s||n.leading!==!1||(s=l);var c=t-(l-s);return i=this,r=arguments,0>=c||c>t?(a&&(clearTimeout(a),a=null),s=l,o=e.apply(i,r),a||(i=r=null)):a||n.trailing===!1||(a=setTimeout(u,c)),o}},b.debounce=function(e,t,n){var i,r,o,a,s,u=function(){var l=b.now()-a;t>l&&l>=0?i=setTimeout(u,t-l):(i=null,n||(s=e.apply(o,r),i||(o=r=null)))};return function(){o=this,r=arguments,a=b.now();var l=n&&!i;return i||(i=setTimeout(u,t)),l&&(s=e.apply(o,r),o=r=null),s}},b.wrap=function(e,t){return b.partial(t,e)},b.negate=function(e){return function(){return!e.apply(this,arguments)}},b.compose=function(){var e=arguments,t=e.length-1;return function(){for(var n=t,i=e[t].apply(this,arguments);n--;)i=e[n].call(this,i);return i}},b.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},b.before=function(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),1>=e&&(t=null),n}},b.once=b.partial(b.before,2);var T=!{toString:null}.propertyIsEnumerable("toString"),N=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];b.keys=function(e){if(!b.isObject(e))return[];if(h)return h(e);var t=[];for(var n in e)b.has(e,n)&&t.push(n);return T&&i(e,t),t},b.allKeys=function(e){if(!b.isObject(e))return[];var t=[];for(var n in e)t.push(n);return T&&i(e,t),t},b.values=function(e){for(var t=b.keys(e),n=t.length,i=Array(n),r=0;n>r;r++)i[r]=e[t[r]];return i},b.mapObject=function(e,t,n){t=_(t,n);for(var i,r=b.keys(e),o=r.length,a={},s=0;o>s;s++)i=r[s],a[i]=t(e[i],i,e);return a},b.pairs=function(e){for(var t=b.keys(e),n=t.length,i=Array(n),r=0;n>r;r++)i[r]=[t[r],e[t[r]]];return i},b.invert=function(e){for(var t={},n=b.keys(e),i=0,r=n.length;r>i;i++)t[e[n[i]]]=n[i];return t},b.functions=b.methods=function(e){var t=[];for(var n in e)b.isFunction(e[n])&&t.push(n);return t.sort()},b.extend=M(b.allKeys),b.extendOwn=b.assign=M(b.keys),b.findKey=function(e,t,n){t=_(t,n);for(var i,r=b.keys(e),o=0,a=r.length;a>o;o++)if(i=r[o],t(e[i],i,e))return i},b.pick=function(e,t,n){var i,r,o={},a=e;if(null==a)return o;b.isFunction(t)?(r=b.allKeys(a),i=y(t,n)):(r=w(arguments,!1,!1,1),i=function(e,t,n){return t in n},a=Object(a));for(var s=0,u=r.length;u>s;s++){var l=r[s],c=a[l];i(c,l,a)&&(o[l]=c)}return o},b.omit=function(e,t,n){if(b.isFunction(t))t=b.negate(t);else{var i=b.map(w(arguments,!1,!1,1),String);t=function(e,t){return!b.contains(i,t)}}return b.pick(e,t,n)},b.defaults=M(b.allKeys,!0),b.create=function(e,t){var n=x(e);return t&&b.extendOwn(n,t),n},b.clone=function(e){return b.isObject(e)?b.isArray(e)?e.slice():b.extend({},e):e},b.tap=function(e,t){return t(e),e},b.isMatch=function(e,t){var n=b.keys(t),i=n.length;if(null==e)return!i;for(var r=Object(e),o=0;i>o;o++){var a=n[o];if(t[a]!==r[a]||!(a in r))return!1}return!0};var I=function(e,t,n,i){if(e===t)return 0!==e||1/e===1/t;if(null==e||null==t)return e===t;e instanceof b&&(e=e._wrapped),t instanceof b&&(t=t._wrapped);var r=d.call(e);if(r!==d.call(t))return!1;switch(r){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!==+e?+t!==+t:0===+e?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t}var o="[object Array]"===r;if(!o){if("object"!=typeof e||"object"!=typeof t)return!1;var a=e.constructor,s=t.constructor;if(a!==s&&!(b.isFunction(a)&&a instanceof a&&b.isFunction(s)&&s instanceof s)&&"constructor"in e&&"constructor"in t)return!1}n=n||[],i=i||[];for(var u=n.length;u--;)if(n[u]===e)return i[u]===t;if(n.push(e),i.push(t),o){if(u=e.length,u!==t.length)return!1;for(;u--;)if(!I(e[u],t[u],n,i))return!1}else{var l,c=b.keys(e);if(u=c.length,b.keys(t).length!==u)return!1;for(;u--;)if(l=c[u],!b.has(t,l)||!I(e[l],t[l],n,i))return!1}return n.pop(),i.pop(),!0};b.isEqual=function(e,t){return I(e,t)},b.isEmpty=function(e){return null==e||(C(e)&&(b.isArray(e)||b.isString(e)||b.isArguments(e))?0===e.length:0===b.keys(e).length)},b.isElement=function(e){return!(!e||1!==e.nodeType)},b.isArray=p||function(e){return"[object Array]"===d.call(e)},b.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},b.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(e){b["is"+e]=function(t){return d.call(t)==="[object "+e+"]"}}),b.isArguments(arguments)||(b.isArguments=function(e){return b.has(e,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(b.isFunction=function(e){return"function"==typeof e||!1}),b.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},b.isNaN=function(e){return b.isNumber(e)&&e!==+e},b.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"===d.call(e)},b.isNull=function(e){return null===e},b.isUndefined=function(e){return void 0===e},b.has=function(e,t){return null!=e&&f.call(e,t)},b.noConflict=function(){return r._=o,this},b.identity=function(e){return e},b.constant=function(e){return function(){return e}},b.noop=function(){},b.property=E,b.propertyOf=function(e){return null==e?function(){}:function(t){return e[t]}},b.matcher=b.matches=function(e){return e=b.extendOwn({},e),function(t){return b.isMatch(t,e)}},b.times=function(e,t,n){var i=Array(Math.max(0,e));t=y(t,n,1);for(var r=0;e>r;r++)i[r]=t(r);return i},b.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},b.now=Date.now||function(){return(new Date).getTime()};var L={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},k=b.invert(L),F=function(e){var t=function(t){return e[t]},n="(?:"+b.keys(e).join("|")+")",i=RegExp(n),r=RegExp(n,"g");return function(e){return e=null==e?"":""+e,i.test(e)?e.replace(r,t):e}};b.escape=F(L),b.unescape=F(k),b.result=function(e,t,n){var i=null==e?void 0:e[t];return void 0===i&&(i=n),b.isFunction(i)?i.call(e):i};var R=0;b.uniqueId=function(e){var t=++R+"";return e?e+t:t},b.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var V=/(.)^/,P={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\u2028|\u2029/g,B=function(e){return"\\"+P[e]};b.template=function(e,t,n){!t&&n&&(t=n),t=b.defaults({},t,b.templateSettings);var i=RegExp([(t.escape||V).source,(t.interpolate||V).source,(t.evaluate||V).source].join("|")+"|$","g"),r=0,o="__p+='";e.replace(i,function(t,n,i,a,s){return o+=e.slice(r,s).replace(j,B),r=s+t.length,n?o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?o+="'+\n((__t=("+i+"))==null?'':__t)+\n'":a&&(o+="';\n"+a+"\n__p+='"),t}),o+="';\n",t.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{var a=new Function(t.variable||"obj","_",o)}catch(e){throw e.source=o,e}var s=function(e){return a.call(this,e,b)},u=t.variable||"obj";return s.source="function("+u+"){\n"+o+"}",s},b.chain=function(e){var t=b(e);return t._chain=!0,t};var U=function(e,t){return e._chain?b(t).chain():t};b.mixin=function(e){b.each(b.functions(e),function(t){var n=b[t]=e[t];b.prototype[t]=function(){var e=[this._wrapped];return l.apply(e,arguments),U(this,n.apply(b,e))}})},b.mixin(b),b.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=a[e];b.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!==e&&"splice"!==e||0!==n.length||delete n[0],U(this,n)}}),b.each(["concat","join","slice"],function(e){var t=a[e];b.prototype[e]=function(){return U(this,t.apply(this._wrapped,arguments))}}),b.prototype.value=function(){return this._wrapped},b.prototype.valueOf=b.prototype.toJSON=b.prototype.value,b.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return b})}).call(this),define("LOG",[],function(){"use strict";var e,t="localhost"===location.hostname,n=t?"DEV":"WARN",i="overrideloglevel",r="__overrideloglevel__",o="undefined"!=typeof console,a=function(){},s=function(){var e=!1,t=o&&"function"==typeof console.log?console.log:null;if(t)try{t("Logger init")}catch(t){e=!0,console.log("Logger init (context-safe)")}return function(t){return e?t.bind(console):t}}(),u=function(e){return o&&"function"==typeof console[e]?s(console[e]):o&&"function"==typeof console.log?s(console.log):a},l=function(t){var i="string"==typeof t?e.LEVEL[t]:t;for(var r in e.LEVEL)if(e.LEVEL.hasOwnProperty(r)){var o=e.LEVEL[r];if(o===i)return o}return e.LEVEL.ERROR.fn("Invalid log level - defaulting to "+n),e.LEVEL[n]},c=function(){var t=new RegExp(i+"=(DEBUG|INFO|DEV|WARN|ERROR|DEFAULT)","i"),o=new RegExp(r+"=(DEBUG|INFO|DEV|WARN|ERROR)"),a=t.test(location.href)&&RegExp.$1.toUpperCase(),s=!a&&o.test(document.cookie||"")&&RegExp.$1;if("DEFAULT"===a){var u=new Date;return u.setDate(u.getDate()-1),document.cookie=r+"=; expires="+u.toUTCString(),e.LEVEL.INFO.fn("[Log level cookie cleared]"),n}return a?(document.cookie=r+"="+encodeURIComponent(a),e.LEVEL.INFO.fn("[Log level overridden by URL parameter]"),a):s?(e.LEVEL.INFO.fn("[Log level overridden by Cookie. To reset add '"+i+"=default' to the URL]"),s):n};return e={LEVEL:{DEBUG:{prio:10,fn:u("debug")},INFO:{prio:20,fn:u("info")},DEV:{prio:25,fn:u("log")},WARN:{prio:30,fn:u("warn")},ERROR:{prio:40,fn:u("error")},OFF:{prio:50,fn:a}},debug:a,info:a,dev:a,warn:a,error:a,setLogLevel:function(t){var n,i,r,o=l(t),s=o.prio;for(var u in e.LEVEL)e.LEVEL.hasOwnProperty(u)&&(n=e.LEVEL[u],n===o&&e.LEVEL.INFO.fn("[Log level: "+u+"]"),i=u.toLowerCase(),r=n.prio>=s,e[i]=r?n.fn:a)}},e.setLogLevel(c()),e}),define("util",["underscore","LOG"],function(e,t){"use strict";var n={},i=0,r={},o=function(e,i){var r=i||1,o=Array.prototype.slice.call(e,r),a=o.length?o:["Assertion failed"],s=n.formatString.apply(null,a);throw t.error(s),s},a=function(e,t,n){return"undefined"==typeof n||0===+n?Math[e](t):(t=+t,n=+n,isNaN(t)||"number"!=typeof n||n%1!==0?NaN:(t=t.toString().split("e"),t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-n:-n))),t=t.toString().split("e"),+(t[0]+"e"+(t[1]?+t[1]+n:n))))};return n={NOP:function(){},nextId:function(){return++i},formatString:function(e){for(var t=""+e,n=1,i=arguments.length;n<i;++n)t=t.replace("{}",arguments[n]);return t},decodeBase64:function(e){var t;try{t=atob(e||"")}catch(n){t=e}return t||""},assert:function(e){e||o(arguments)},assertDefined:function(e){"undefined"!=typeof e||o(arguments)},assertBoolean:function(e){"boolean"==typeof e||o(arguments)},assertBooleanOrUndefined:function(e){"boolean"==typeof e||"undefined"==typeof e||o(arguments)},assertString:function(e){"string"==typeof e||o(arguments)},assertNonEmptyString:function(e){"string"==typeof(!!e&&e)||o(arguments)},assertStringOrEmpty:function(e){!e||"string"==typeof e||o(arguments)},assertNumber:function(e){"number"==typeof e||o(arguments)},assertNumberInRange:function(e,t,n){"number"==typeof e&&e>=t&&e<=n||o(arguments,3)},assertNumberInRangeOrEmpty:function(e,t,n){!e||"number"==typeof e&&e>=t&&e<=n||o(arguments,3)},assertFunction:function(e){"function"==typeof e||o(arguments)},assertFunctionOrEmpty:function(e){!e||"function"==typeof e||o(arguments)},assertObject:function(e){e&&"object"==typeof e||o(arguments)},assertObjectOrEmpty:function(e){!e||"object"==typeof e||o(arguments)},assertArray:function(e){e&&e instanceof Array||o(arguments)},assertNonEmptyArray:function(e){e&&e instanceof Array&&e.length||o(arguments)},assertArrayOrEmpty:function(e){!e||e instanceof Array||o(arguments)},assertElement:function(t){t&&e.isElement(t)||o(arguments)},assertObjectHasProperties:function(e,n){this.assertObject(e,arguments[2]||"Given obj parameter is not an object"),(n||[]).forEach(function(n){"undefined"==typeof e[n]&&(t.warn(arguments[2]||"Given object is invalid"),o([e,'Missing property: "{}"']))})},isNumberInRange:function(e,t,n){return!isNaN(e)&&e>=t&&e<=n},extend:function(t,n){return e.extend.apply(e,arguments)},startTimer:function(e){this.assert(!!e,"invalid id for util.startTime: ",e),r[""+e]=+new Date},extendClass:function(t,n){this.assertFunction(t,"Expected a constructor function for lep.util.extendClass superClass"),this.assert(!t.prototype||!t.prototype._super,"util.extendClass does not support long prototype chains");var i=function(){};i.prototype=t.prototype;for(var r=n._init,o=function(){r.apply(this,arguments)},a=this.extend(new i,n),s=2;s<arguments.length;s++)e.extend(a,arguments[s]);return delete a._init,a._super=function(){t.apply(this,arguments)},o.prototype=a,o},paddLeft:function(e,t,n){for(var i=""+e,r=t-i.length,o=n||"0";r>0;r--)i=o+i;return i},stopTimer:function(e){var t=+new Date;return t-(r[""+e]||t+1)},round10:function(e,t){return a("round",e,-(t||0))}}}),function(e,t){"function"==typeof define&&define.amd?define("X2JS",[],t):"object"==typeof exports?module.exports=t():e.X2JS=t()}(this,function(){return function(e){function t(){void 0===e.escapeMode&&(e.escapeMode=!0),e.attributePrefix=e.attributePrefix||"_",e.arrayAccessForm=e.arrayAccessForm||"none",e.emptyNodeForm=e.emptyNodeForm||"text",void 0===e.enableToStringFunc&&(e.enableToStringFunc=!0),e.arrayAccessFormPaths=e.arrayAccessFormPaths||[],void 0===e.skipEmptyTextNodesForObj&&(e.skipEmptyTextNodesForObj=!0),void 0===e.stripWhitespaces&&(e.stripWhitespaces=!0),e.datetimeAccessFormPaths=e.datetimeAccessFormPaths||[],void 0===e.useDoubleQuotes&&(e.useDoubleQuotes=!1),e.xmlElementsFilter=e.xmlElementsFilter||[],e.jsonPropertiesFilter=e.jsonPropertiesFilter||[],void 0===e.keepCData&&(e.keepCData=!1)}function n(){}function i(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!=t||(t=e.nodeName),t}function r(e){return e.prefix}function o(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):e}function a(e,t,n,i){for(var r=0;r<e.length;r++){var o=e[r];if("string"==typeof o){if(o==i)break}else if(o instanceof RegExp){if(o.test(i))break}else if("function"==typeof o&&o(t,n,i))break}return r!=e.length}function s(t,n,i){switch(e.arrayAccessForm){case"property":t[n]instanceof Array?t[n+"_asArray"]=t[n]:t[n+"_asArray"]=[t[n]]}!(t[n]instanceof Array)&&e.arrayAccessFormPaths.length>0&&a(e.arrayAccessFormPaths,t,n,i)&&(t[n]=[t[n]])}function u(e){var t=e.split(/[-T:+Z]/g),n=new Date(t[0],t[1]-1,t[2]),i=t[5].split(".");if(n.setHours(t[3],t[4],i[0]),i.length>1&&n.setMilliseconds(i[1]),t[6]&&t[7]){var r=60*t[6]+Number(t[7]),o=/\d\d-\d\d:\d\d$/.test(e)?"-":"+";r=0+("-"==o?-1*r:r),n.setMinutes(n.getMinutes()-r-n.getTimezoneOffset())}else e.indexOf("Z",e.length-1)!==-1&&(n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())));return n}function l(t,n,i){if(e.datetimeAccessFormPaths.length>0){var r=i.split(".#")[0];return a(e.datetimeAccessFormPaths,t,n,r)?u(t):t}return t}function c(t,n,i,r){return!(n==D.ELEMENT_NODE&&e.xmlElementsFilter.length>0)||a(e.xmlElementsFilter,t,i,r)}function d(t,n){if(t.nodeType==D.DOCUMENT_NODE){for(var o=new Object,a=t.childNodes,u=0;u<a.length;u++){var f=a.item(u);if(f.nodeType==D.ELEMENT_NODE){var p=i(f);o[p]=d(f,p)}}return o}if(t.nodeType==D.ELEMENT_NODE){var o=new Object;o.__cnt=0;for(var a=t.childNodes,u=0;u<a.length;u++){var f=a.item(u),p=i(f);if(f.nodeType!=D.COMMENT_NODE){var h=n+"."+p;c(o,f.nodeType,p,h)&&(o.__cnt++,null==o[p]?(o[p]=d(f,h),s(o,p,h)):(null!=o[p]&&(o[p]instanceof Array||(o[p]=[o[p]],s(o,p,h))),o[p][o[p].length]=d(f,h)))}}for(var g=0;g<t.attributes.length;g++){var m=t.attributes.item(g);o.__cnt++,o[e.attributePrefix+m.name]=m.value}var v=r(t);return null!=v&&""!=v&&(o.__cnt++,o.__prefix=v),null!=o["#text"]&&(o.__text=o["#text"],o.__text instanceof Array&&(o.__text=o.__text.join("\n")),e.stripWhitespaces&&(o.__text=o.__text.trim()),delete o["#text"],"property"==e.arrayAccessForm&&delete o["#text_asArray"],o.__text=l(o.__text,p,n+"."+p)),null!=o["#cdata-section"]&&(o.__cdata=o["#cdata-section"],delete o["#cdata-section"],"property"==e.arrayAccessForm&&delete o["#cdata-section_asArray"]),0==o.__cnt&&"text"==e.emptyNodeForm?o="":1==o.__cnt&&null!=o.__text?o=o.__text:1!=o.__cnt||null==o.__cdata||e.keepCData?o.__cnt>1&&null!=o.__text&&e.skipEmptyTextNodesForObj&&(e.stripWhitespaces&&""==o.__text||""==o.__text.trim())&&delete o.__text:o=o.__cdata,delete o.__cnt,!e.enableToStringFunc||null==o.__text&&null==o.__cdata||(o.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),o}if(t.nodeType==D.TEXT_NODE||t.nodeType==D.CDATA_SECTION_NODE)return t.nodeValue}function f(t,n,i,r){var a="<"+(null!=t&&null!=t.__prefix?t.__prefix+":":"")+n;if(null!=i)for(var s=0;s<i.length;s++){var u=i[s],l=t[u];e.escapeMode&&(l=o(l)),a+=" "+u.substr(e.attributePrefix.length)+"=",a+=e.useDoubleQuotes?'"'+l+'"':"'"+l+"'"}return a+=r?"/>":">"}function p(e,t){return"</"+(null!=e.__prefix?e.__prefix+":":"")+t+">"}function h(e,t){return e.indexOf(t,e.length-t.length)!==-1}function g(t,n){return!!("property"==e.arrayAccessForm&&h(n.toString(),"_asArray")||0==n.toString().indexOf(e.attributePrefix)||0==n.toString().indexOf("__")||t[n]instanceof Function)}function m(e){var t=0;if(e instanceof Object)for(var n in e)g(e,n)||t++;return t}function v(t,n,i){return 0==e.jsonPropertiesFilter.length||""==i||a(e.jsonPropertiesFilter,t,n,i)}function b(t){var n=[];if(t instanceof Object)for(var i in t)i.toString().indexOf("__")==-1&&0==i.toString().indexOf(e.attributePrefix)&&n.push(i);return n}function y(t){var n="";return null!=t.__cdata&&(n+="<![CDATA["+t.__cdata+"]]>"),null!=t.__text&&(n+=e.escapeMode?o(t.__text):t.__text),n}function _(t){var n="";return t instanceof Object?n+=y(t):null!=t&&(n+=e.escapeMode?o(t):t),n}function M(e,t){return""===e?t:e+"."+t}function x(e,t,n,i){var r="";if(0==e.length)r+=f(e,t,n,!0);else for(var o=0;o<e.length;o++)r+=f(e[o],t,b(e[o]),!1),r+=E(e[o],M(i,t)),r+=p(e[o],t);return r}function E(e,t){var n="",i=m(e);if(i>0)for(var r in e)if(!g(e,r)&&(""==t||v(e,r,M(t,r)))){var o=e[r],a=b(o);if(null==o||void 0==o)n+=f(o,r,a,!0);else if(o instanceof Object)if(o instanceof Array)n+=x(o,r,a,t);else if(o instanceof Date)n+=f(o,r,a,!1),n+=o.toISOString(),n+=p(o,r);else{var s=m(o);s>0||null!=o.__text||null!=o.__cdata?(n+=f(o,r,a,!1),n+=E(o,M(t,r)),n+=p(o,r)):n+=f(o,r,a,!0)}else n+=f(o,r,a,!1),n+=_(o),n+=p(o,r)}return n+=_(e)}var A="1.2.0";e=e||{},t(),n();var D={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};this.parseXmlString=function(e){var t=window.ActiveXObject||"ActiveXObject"in window;if(void 0===e)return null;var n;if(window.DOMParser){var i=new window.DOMParser,r=null;if(!t)try{r=i.parseFromString("INVALID","text/xml").getElementsByTagName("parsererror")[0].namespaceURI}catch(e){r=null}try{n=i.parseFromString(e,"text/xml"),null!=r&&n.getElementsByTagNameNS(r,"parsererror").length>0&&(n=null)}catch(e){n=null}}else 0==e.indexOf("<?")&&(e=e.substr(e.indexOf("?>")+2)),n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(e);return n},this.asArray=function(e){return void 0===e||null==e?[]:e instanceof Array?e:[e]},this.toXmlDateTime=function(e){return e instanceof Date?e.toISOString():"number"==typeof e?new Date(e).toISOString():null},this.asDateTime=function(e){return"string"==typeof e?u(e):e},this.xml2json=function(e){return d(e)},this.xml_str2json=function(e){var t=this.parseXmlString(e);return null!=t?this.xml2json(t):null},this.json2xml_str=function(e){return E(e,"")},this.json2xml=function(e){var t=this.json2xml_str(e);return this.parseXmlString(t)},this.getVersion=function(){return A}}}),define("AMD/file/JsonXmlConverter",["X2JS","util"],function(e,t){"use strict";function n(){var n='<?xml version="1.0" encoding="UTF-8"?>',i=new e({skipEmptyTextNodesForObj:!1,useDoubleQuotes:!0,arrayAccessFormPaths:["layout.tabpage","layout.tabpage.control","layout.tabpage.control.midi"]});this.xml2json=function(e){return t.assertStringOrEmpty(e,"Invalid xml for JsonXmlConverter.xml2json"),e?i.xml_str2json(e):null},this.json2xml=function(e,r){t.assertObjectOrEmpty(e,"Invalid json for JsonXmlConverter.xml2json");var o=r?"":n;return e?o+i.json2xml_str(e):""}}var i;return{getInstance:function(){return i||(i=new n),i}}}),define("AMD/midi/MessageTypes",["knockout","underscore","util","LOG"],function(e,t,n,i){"use strict";function r(e,i,r,o){n.assertNumberInRange(e,0,9,'Invalid id for MessageType "{}"',i),n.assertNonEmptyString(i,"Invalid name for MessageType {}",e),n.assertNonEmptyString(r,"Invalid shortName for MessageType {}",e),n.assertObjectOrEmpty(o,'Invalid propsOverrides for MessageType "{}": {}',i,o),this.id=e,this.name=i,this.shortName=r,this.channelMin=1,this.channelMax=16,this.data1Min=0,this.data1Max=127,this.data2fMin=0,this.data2fMax=127,this.data2tMin=0,this.data2tMax=127,this.sysex=!1,this.data1IsNote=!1,this.data1IsCC=!1,t.extend(this,o),this.channelOptions=t.range(1,1+this.channelMax),this.hasFixChannel=1===this.channelOptions.length,this.hasFixData1=this.data1Min===this.data1Max,this.hasFixData2f=this.data2fMin===this.data2fMax,this.hasFixData2t=this.data2tMin===this.data2tMax,this.hasSysex=this.sysex===!0,this.hasData2Range=!this.hasFixData2f&&!this.hasFixData2t}var o={all:[],basic:[],byId:{}},a={channelMax:1,data1Max:0,data2fMax:0,data2tMin:127},s=/^\d+$/,u=/^([0-9a-f]{2}?)+$/i;return r.prototype={isValidChannel:function(e){return"number"==typeof e&&s.test(""+e)&&e>=this.channelMin&&e<=this.channelMax},isValidData1:function(e){return"number"==typeof e&&s.test(""+e)&&e>=this.data1Min&&e<=this.data1Max},isValidData2f:function(e){return"number"==typeof e&&s.test(""+e)&&e>=this.data2fMin&&e<=this.data2fMax},isValidData2t:function(e){return"number"==typeof e&&s.test(""+e)&&e>=this.data2tMin&&e<=this.data2tMax},isValidSysex:function(e){return!this.sysex&&""===e||this.sysex&&u.test(e)},_createValidMidiObject:function(e,t,n,i,r,o){var a=this.isValidChannel(e)&&this.isValidData1(t)&&this.isValidData2f(n)&&this.isValidData2t(i)&&this.isValidSysex(r),s=null;return a&&(s={},s._type=this.id,s._channel=e,s._data1=t,s._data2f=n,s._data2t=i,s._sysex=r,o&&(s._var=o)),s},createValidControlMidiObject:function(e,t,i,r,o,a){return n.assertNonEmptyString(e,"Invalid varName for createValidControlMidiObject"),this._createValidMidiObject(t,i,r,o,a,e)},noteOptions:t.range(0,128),data2Label:"Range (data2)"},r.create=function(e,t,n,i){var a=new r(e,t,n,i);return o.all.push(a),o.byId[e]=a,a},r.createBasic=function(e,t,n,i){var a=r.create(e,t,n,i);return o.basic.push(a),a},o.CC=r.createBasic(0,"Control Change","CC",{data1IsCC:!0}),o.NOTE=r.createBasic(1,"Note","Note",{data1IsNote:!0,data2Label:"Velocity"}),o.PROGRAM_CHANGE=r.createBasic(2,"Program Change","PrChg",{data1Max:0}),o.POLY_PRESSURE=r.createBasic(6,"Poly Pressure","PPres",{data1IsNote:!0}),o.CHANNEL_PRESSURE=r.createBasic(7,"Channel Pressure","ChPres",{data1Max:0}),o.PITCHBEND=r.createBasic(8,"PitchBend","PBend",{data1Max:0,data2tMax:16383}),o.START=r.create(3,"Start","Start",a),o.STOP=r.create(4,"Stop","Stop",a),o.CONTINUE=r.create(5,"Continue","Continue",a),o.SYSEX=r.create(9,"Sysex","Sysex",t.extend({},a,{sysex:!0})),o.forMidiMultiEdit=o.basic,o}),define("AMD/midi/MidiOpts",["underscore","AMD/midi/MessageTypes"],function(e,t){"use strict";function n(n,a,s,u,l,c){this.getValueVars="function"==typeof n?n:f(e.flatten(n)),this.getTouchVars="function"==typeof s?s:f(e.flatten(s)),this.getColorVars="function"==typeof l?l:f(e.flatten(l)),this.valueTypes=a===i?t.all:a===r?t.basic:a===o?e.union(t.basic,[t.SYSEX]):[],this.touchTypes=u===i?t.all:u===r?t.basic:[],this.colorTypes=c===i?t.all:c===r?t.basic:[]}var i="all_message_types",r="basic_message_types",o="tabpage_types",a=function(){
var t=this.props;return e.chain(e.range(1,t._number_x*t._number_y+1)).map(function(e){return"x"+e}).value()},s=function(){var t=this.props;return e.chain(e.range(1,t._number_x*t._number_y+1)).map(function(e){return"c"+e}).value().concat("c")},u=e.chain(e.range(1,6)).map(function(e){return["x"+e,"y"+e]}).flatten().value(),l=e.chain(e.range(1,6)).map(function(e){return"z"+e}).value(),c=function(){var t=this.props;return e.chain(e.range(1,t._number+1)).map(function(e){return"x"+e}).value()},d=function(){var t=this.props;return e.chain(e.range(1,t._number+1)).map(function(e){return"c"+e}).value().concat("c")},f=function(e){return function(){return e}};return n.prototype={updateMidiOpts:function(){this.valueVars=this.getValueVars(),this.touchVars=this.getTouchVars(),this.colorVars=this.getColorVars()}},e.extend(n,{LED:new n("x",r,null,null,"c",r),LABEL:new n("x",r,null,null,"c",r),PUSH:new n("x",i,"z",i,"c",r),TOGGLE:new n("x",i,"z",i,"c",r),XY:new n(["x","y"],r,"z",i,"c",r),FADER:new n("x",r,"z",i,"c",r),ROTARY:new n("x",r,"z",i,"c",r),ENCODER:new n("x",r,"z",i,"c",r),BATTERY:new n(null,null,null,null,"c",r),TIME:new n(null,null,null,null,"c",r),MULTIPUSH:new n(a,i,"z",i,s,r),MULTITOGGLE:new n(a,i,"z",i,s,r),MULTIXY:new n(u,r,l,i,"c",r),MULTIFADER:new n(c,r,"z",i,d,r),TABPAGE_CONTROL_ADAPTER:new n("x",o,null,null,null,null)}),n}),define("AMD/midi/MidiUtil",["underscore","util","LOG","AMD/midi/MessageTypes"],function(e,t,n,i){"use strict";function r(e){var t=Math.floor((e-24)/12);return s[e%12]+t}function o(e){var t=Math.floor((e-24)/12),n=s[e%12].replace(/^(.)/,"$1"+t);return e+" ("+n+")"}function a(e,t){var n=e&&i.byId[e._type];if(!n)return"- none -";var r=[],a=n.shortName,s=e._data1,u=t&&n===i.NOTE?o(s):s;return n.hasFixData1?r.push(a):r.push(n.shortName+" "+u),n.hasFixData2f||n.hasFixData2t||r.push("["+e._data2f+"-"+e._data2t+"]"),n.hasFixChannel||r.push(" [Ch"+e._channel+"]"),r.join(" ")}var s=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return{getNoteName:r,getDetailedNoteName:o,NOTE_NAMES:s,midiJsonToString:a,MessageTypes:i}}),define("AMD/control/SvgControlTemplates",["jquery","underscore","LOG","util"],function(e,t,n,i){"use strict";function r(){var r={},o=null;this.getTemplateIdForControlType=function(e){var n=t.chain(r).map(function(t,n){return t.test(e)?n:null}).compact().value();return i.assert(n.length<2,'Multiple svg templates found for typeId "{}": {}',e,n),n[0]||o},e("script.svg__controlTemplate").each(function(){var e=this.id,t=this.getAttribute("data-typepattern"),i=""===t,a=!i&&new RegExp(t);i?(o=e,n.dev('Found SVG fallback template "%s"',e)):r[e]=a}),i.assertString(o,"SvgControlTemplates could not find any fallback template!")}var o=null;return{getInstance:function(){return o||(o=new r),o}}}),define("AMD/control/Control",["underscore","util","LOG","AMD/midi/MidiOpts","AMD/midi/MidiUtil","AMD/control/SvgControlTemplates","AMD/midi/MessageTypes"],function(e,t,n,i,r,o){"use strict";function a(e){t.assertString(e&&e._type,"Invalid control json for Control. ",e),this.uid="ctrl_"+(++s).toString(36),this.typeName=this.BASE_TYPE_NAME+(null===this.isVertical?"":this.isVertical===!0?"-V":"-H"),this.props=e,this.updateColorCode(),this.updateMidiOpts(),this.updateIsVertical()}var s=1,u="___control_adapter__";return a.prototype={BASE_TYPE_NAME:"Control",TYPE_IDS:[],isVertical:null,setType:function(e){t.assertString(!!e&&e,"Invalid new type %o for control %o",e,this),this.props._type=e,this.updateIsVertical()},setColor:function(e){t.assertString(!!e&&e,"Invalid new color %o for control %o",e,this),this.props._color=e,this.updateColorCode()},updateIsVertical:function(){this.isVertical=2!==this.TYPE_IDS.length?null:"v"===this.props._type[this.props._type.length-1]},colorCodes:{},updateColorCode:function(){var e=this.props._color;this.colorCode=e?this.colorCodes[e]||e:"orange"},updateMidiOpts:function(){throw n.error("Control class of %o has NO overridden version of #updateMidiOpts()",this),"Unexpected call of Control.prototype.updateMidiOpts()"},valueVars:null,touchVars:null,colorVars:null,valueTypes:null,touchTypes:null,colorTypes:null,getValueForMidiVar:function(t){return e.findWhere(this.props.midi,{_var:t})},getValueStringForMidiVar:function(t,n){var i=e.findWhere(this.props.midi,{_var:t});return i?r.midiJsonToString(i,n):"-"},setMidi:function(t){var i=this.getValueForMidiVar(t._var);i?(e.extend(i,t),n.dev("Updated MIDI object %o of control %o",t,this)):(n.dev("Added new MIDI object %o to control %o",t,this),this.props.midi.push(JSON.parse(JSON.stringify(t))))},removeMidiVar:function(e){var t=this.getValueForMidiVar(e),i=t&&this.props.midi.indexOf(t);i>=0&&(n.dev("Removing MIDI object %o from control %o",t,this),this.props.midi.splice(i,1))},getMidiVarNamesByAspect:function(e,t,n){return e?this.valueVars:t?this.touchVars:n?this.colorVars:null},removeAllMidiByAspect:function(t,n,i){var r=this,o=this.getMidiVarNamesByAspect(t,n,i);e.each(o,function(e){r.removeMidiVar(e)})},removeAllValueMidi:function(){this.removeAllMidiByAspect(!0,!1,!1)},removeAllTouchMidi:function(){this.removeAllMidiByAspect(!1,!0,!1)},removeAllColorMidi:function(){this.removeAllMidiByAspect(!1,!1,!0)},finalizePropertyEdit:t.NOP},a.REGISTERED_CLASSES=[],a.REGISTERED_CLASSES_BY_TYPE_ID={},a.createSubclass=function(e,r,s,l){t.assertString(!!e&&e,"Invalid baseTypeName for Control.createSubclass: {}",e),t.assertNonEmptyArray(r,"Invalid supportedTypeIds for Control.createSubclass",r),t.assert(s instanceof i,"Invalid midiOpts for Control.createSubclass",s),t.assertObject(l,"Missing new prototype for Control.createSubclass");var c=0===e.indexOf(u),d=o.getInstance().getTemplateIdForControlType(r[0]),f=t.extendClass(a,l,s,{BASE_TYPE_NAME:e,TYPE_IDS:r,svgTemplateId:d});if(f.supportsTypeId=function(e){return this.prototype.TYPE_IDS.indexOf(e)>=0},c)n.dev('Defined ControlAdapter class, pseudo-type: "%s"',e);else{a.REGISTERED_CLASSES.push(f);for(var p=0;p<r.length;p++)a.REGISTERED_CLASSES_BY_TYPE_ID[r[p]]=f;n.debug('Registered new Control class "%s", svgTemplateId="%s"',e,d)}return f},a.createAdapterClass=function(e,t,n){var i=u+e;return a.createSubclass(i,[i],t,n)},a}),define("AMD/control/Label",["underscore","util","AMD/control/Control","AMD/midi/MidiOpts"],function(e,t,n,i){"use strict";return n.createSubclass("Label",["labelh","labelv"],i.LABEL,{_init:function(e){this._super(e)},colorCodes:{red:"#FF281C",green:"#75CC26",blue:"#00C4A8",yellow:"#FFED00",purple:"#AA7FAA",gray:"#B2B2B2",orange:"#F9A01C",brown:"#826647",pink:"#FF05F2"}})}),define("AMD/control/TabPageControlAdapter",["underscore","util","LOG","AMD/control/Control","AMD/midi/MidiOpts"],function(e,t,n,i,r){"use strict";var o="__TAB_PAGE__",a="_midi",s=/^_midi/,u=/^_(?:name|scalef|scalet|osc_cs)$/,l=i.createAdapterClass("TabPage",r.TABPAGE_CONTROL_ADAPTER,{_init:function(t){var n=e.reduce(t,function(e,t,n){var i=s.test(n),r=!i&&u.test(n);if(i){var o=e.midi[0];o||(o={_var:"x"},e.midi[0]=o),o[n.replace(s,"")]=t}else r&&(e[n]=t);return e},{midi:[],_type:o,_osc_cs:""});this._super(n),this.originalJson=t},finalizePropertyEdit:function(){t.assert(1===this.valueVars.length&&"x"===this.valueVars[0],"Unexpected MidiOpts");var i=this,r=i.originalJson,o=this.props.midi[0];e.each(this.props,function(e,t){"midi"!==t&&u.test(t)&&(n.dev("Updating %s=%o",t,e),r[t]=e)}),o?e.each(o,function(e,t){r[a+t]=e}):e.each(e.keys(r),function(e){s.test(e)&&delete r[e]})}});return l}),define("AMD/control/Battery",["underscore","util","AMD/control/Control","AMD/midi/MidiOpts"],function(e,t,n,i){"use strict";return n.createSubclass("Battery",["batteryh","batteryv"],i.BATTERY,{_init:function(e){this._super(e)},getFixText:function(){return"100%"}})}),define("AMD/control/Encoder",["underscore","util","AMD/control/Control","AMD/midi/MidiOpts"],function(e,t,n,i){"use strict";return n.createSubclass("Encoder",["encoder"],i.ENCODER,{_init:function(e){this._super(e)}})}),define("AMD/control/Fader",["underscore","util","AMD/control/Control","AMD/midi/MidiOpts"],function(e,t,n,i){"use strict";n.createSubclass("Fader",["faderh","faderv"],i.FADER,{_init:function(e){this._super(e)}})}),define("AMD/control/LED",["underscore","util","AMD/control/Control","AMD/midi/MidiOpts"],function(e,t,n,i){"use strict";return n.createSubclass("LED",["led"],i.LED,{_init:function(e){this._super(e)},colorCodes:{red:"#ae2a2a",green:"#2aae2a",blue:"#2424a6",yellow:"#afaf16",purple:"#6d0a6d",gray:"#4f4f4f",orange:"#d67c00",brown:"#372806",pink:"#ff5bff"}})}),define("AMD/control/MultiFader",["underscore","util","AMD/control/Control","AMD/midi/MidiOpts"],function(e,t,n,i){"use strict";return n.createSubclass("MultiFader",["multifaderh","multifaderv"],i.MULTIFADER,{_init:function(e){this._super(e)}})}),define("AMD/control/MultiPush",["underscore","util","AMD/control/Control","AMD/midi/MidiOpts"],function(e,t,n,i){"use strict";return n.createSubclass("MultiPush",["multipush"],i.MULTIPUSH,{_init:function(e){this._super(e),this.needsGrid=e._number_x>1||e._number_y>1}})}),define("AMD/control/MultiToggle",["underscore","util","AMD/control/Control","AMD/midi/MidiOpts"],function(e,t,n,i){"use strict";return n.createSubclass("MultiToggle",["multitoggle"],i.MULTITOGGLE,{_init:function(e){this._super(e),this.needsGrid=e._number_x>1||e._number_y>1}})}),define("AMD/control/MultiXY",["underscore","util","AMD/control/Control","AMD/midi/MidiOpts"],function(e,t,n,i){"use strict";return n.createSubclass("MultiXY",["multixy"],i.MULTIXY,{_init:function(e){this._super(e)}})}),define("AMD/control/Push",["underscore","util","AMD/control/Control","AMD/midi/MidiOpts"],function(e,t,n,i){"use strict";return n.createSubclass("Push",["push"],i.PUSH,{_init:function(e){this._super(e)}})}),define("AMD/control/Rotary",["underscore","util","AMD/control/Control","AMD/midi/MidiOpts"],function(e,t,n,i){"use strict";return n.createSubclass("Rotary",["rotaryh","rotaryv"],i.ROTARY,{_init:function(e){this._super(e)}})}),define("AMD/control/Time",["underscore","util","AMD/control/Control","AMD/midi/MidiOpts"],function(e,t,n,i){"use strict";return n.createSubclass("Time",["timeh","timev"],i.TIME,{_init:function(e){this._super(e)},getFixText:function(){return this.props._seconds?"11:33:55":"11:33"}})}),define("AMD/control/Toggle",["underscore","util","AMD/control/Control","AMD/midi/MidiOpts"],function(e,t,n,i){"use strict";return n.createSubclass("Toggle",["toggle"],i.TOGGLE,{_init:function(e){this._super(e)}})}),define("AMD/control/XY",["underscore","util","AMD/control/Control","AMD/midi/MidiOpts"],function(e,t,n,i){"use strict";return n.createSubclass("XY",["xy"],i.XY,{_init:function(e){this._super(e)}})}),define("AMD/control/ControlSupport",["underscore","util","LOG","AMD/control/Control","AMD/control/Label","AMD/control/TabPageControlAdapter","AMD/control/Battery","AMD/control/Encoder","AMD/control/Fader","AMD/control/LED","AMD/control/MultiFader","AMD/control/MultiPush","AMD/control/MultiToggle","AMD/control/MultiXY","AMD/control/Push","AMD/control/Rotary","AMD/control/Time","AMD/control/Toggle","AMD/control/XY"],function(e,t,n,i,r,o){"use strict";function a(e){return i.REGISTERED_CLASSES_BY_TYPE_ID[e]}function s(e){var t=e._type,n=a(t);if(!n)throw"No matching control subclass for Control JSON: "+JSON.stringify(e,null,2);return new n(e)}function u(e){return t.assertObject(e,"Invalid json for createControlAdapterByTabPageJson"),new o(e)}return{getClassByTypeId:a,createControlByJson:s,createControlAdapterByTabPageJson:u,REGISTERED_CLASSES_BY_TYPE_ID:i.REGISTERED_CLASSES_BY_TYPE_ID,REGISTERED_CLASSES:i.REGISTERED_CLASSES,REGISTERED_BASE_TYPE_NAMES:e.chain(i.REGISTERED_CLASSES).map(function(e){return e.prototype.BASE_TYPE_NAME}).value().sort(),isControl:function(e){return e instanceof i},isTabPageControlAdapter:function(e){return e instanceof o},isLabel:function(e){return e instanceof r},ALL_COLORS:["red","green","blue","yellow","purple","gray","orange","brown","pink"]}}),define("koToggleableExtender",["knockout"],function(e){"use strict";e.extenders.toggleable=function(e,t){e.toggleOn=function(){e(!0)},e.toggleOff=function(){e(!1)},e.toggle=function(){e(!e())}}}),define("AMD/ControlFilter",["knockout","util","LOG","underscore","AMD/control/ControlSupport","koToggleableExtender"],function(e,t,n,i,r){"use strict";function o(){var o=this,a=r.REGISTERED_BASE_TYPE_NAMES,s=i.reduce(a,function(t,n){return t[n]={isVisible:e.observable(!0).extend({toggleable:!0}),count:e.observable(0),controlType:n},t},{});this.ALL_COLORS=r.ALL_COLORS,this.allowedColors=i.reduce(this.ALL_COLORS,function(t,n){return t[n]=e.observable(!1).extend({toggleable:!0}),t},{}),this.isCountFilterEnabled=e.observable(!0),this.isVisible=e.observable(!1).extend({toggleable:!0}),this.isOpen=e.observable(!0).extend({toggleable:!0}),this.resetColors=function(){i.invoke(o.allowedColors,"toggleOn")},this.colorClick=function(e,t){var n=o.allowedColors[e];if(t.shiftKey){var r=n()&&1===i.reduce(o.allowedColors,function(e,t){return t()?e+1:e},0);i.each(o.allowedColors,function(e){e(r||e===n)})}else n.toggle()},this.hideAll=function(){i.invoke(s,"isVisible",!1)},this.reset=function(){i.invoke(s,"isVisible",!0),o.resetColors()},this.showAllButLabels=function(){i.each(s,function(e,t){e.isVisible(!/label/i.test(t))})},this.isControlVisible=function(e){var t=e&&s[e.BASE_TYPE_NAME],n=t&&t.isVisible(),i=e.props._color,r=t&&(!i||!o.allowedColors[i]||o.allowedColors[i]());return!(!n||!r)},this.updateCounts=function(e){t.assertObject(e,"Invalid baseTypeName2countMap object for ControlFilter.updateCounts");var r=i.union(a,i.keys(e));i.each(r,function(t){s[t]?s[t].count(e[t]||0):(n.warn('Yet unsupported baseName: "%s"',t),alert('Unsupported control baseName: "'+t+'"'))})},this.getCountById=function(e){return s[e]?s[e].count():0},this.soloType=function(e){i.each(s,function(t){t.isVisible(t===e)})},this.options=e.pureComputed(function(){var e=o.isCountFilterEnabled(),t=e?i.filter(a,function(e){return s[e].count()}):a;return i.map(t,function(e){return s[e]})}),this.reset(),this.updateCounts({})}var a=null;return{getInstance:function(){return a||(a=new o),a}}}),define("AMD/VisualConfig",["knockout","util","koToggleableExtender"],function(e,t){"use strict";function n(){var n=this;this.markEmptyLabels=e.observable(!0).extend({toggleable:!0}),this.isTooltipEnabled=e.observable(!0),this.zoom=e.observable(1),this.zoomIn=function(){var e=n.zoom(),i=e<o?.05:.25,r=Math.min(2,e+i);n.zoom(t.round10(r,2))},this.zoomOut=function(){var e=n.zoom(),i=e<=o?.05:.25,a=Math.max(r,e-i);n.zoom(t.round10(a,2))},this.zoomReset=function(){n.zoom(1)}}var i=null,r=.05,o=.25;return{getInstance:function(){return i||(i=new n),i}}}),define("AMD/file/JsonSanitizer",["underscore","LOG","util","jquery"],function(e,t,n,i){"use strict";function r(n,i){e.each(i,function(e){var i,r=n[e];"string"==typeof r&&(i=Number(r),"number"==typeof i?n[e]=i:t.error('Error converting property "%s" with value "%o" into number.',e,r))})}function o(t,i){e.each(i,function(e){var i=t[e];"string"==typeof i&&(n.assert("true"===i||"false"===i,'Invalid boolean string in property "{}"',e),t[e]="true"===i)})}function a(e,t,i){i&&e[t]&&(e[t]=n.decodeBase64(e[t]))}function s(e,t){var n=e[t];n&&"string"==typeof n&&(e[t]=btoa(n))}function u(e,t){if("push"===e._type){var n=!!e[g],i=n&&!!e[m];t?(n&&i?e[m]="1":delete e[m],n?e[g]="1":delete e[g]):(e[g]=n,e[m]=i)}}function l(e,t){var n=i.trim(e._osc_cs||"");n||(t?delete e._osc_cs:e._osc_cs="")}function c(i,s){if(i){n.assertBoolean(s&&s.namesNeedDecoding,"Invalid namesNeedDecoding param for sanitizeJson"),n.assertBoolean(s&&s.textsNeedDecoding,"Invalid textsNeedDecoding param for sanitizeJson"),r(i.layout,p.LAYOUT),e.each(i.layout.tabpage,function(t,n){a(t,"_name",s.namesNeedDecoding),r(t,p.TABPAGE),a(t,"_osc_cs",!0),t.control||(t.control=[]),e.each(t.control,function(t){a(t,"_name",s.namesNeedDecoding),a(t,"_text",s.textsNeedDecoding),a(t,"_osc_cs",!0),r(t,p.CONTROL),o(t,h.CONTROL),l(t),u(t,!1),t.midi||(t.midi=[]),e.each(t.midi,function(e){r(e,p.MIDI)})})});var c=JSON.stringify(i),d=c.indexOf(':"false"');d=d>0?d:c.indexOf(':"true"'),d>0&&t.warn("Sanitized JSON may still contain unconverted boolean strings near:\n[...] %s",c.substr(d-20,30))}}function d(e){e.midi&&!e.midi.length&&delete e.midi,e.control&&!e.control.length&&delete e.control}function f(t){t&&e.each(t.layout.tabpage,function(t,n){s(t,"_name"),d(t),s(t,"_osc_cs"),e.each(t.control,function(e){s(e,"_name"),s(e,"_text"),l(e,!0),s(e,"_osc_cs"),u(e,!0),d(e)})})}var p={MIDI:["_channel","_type","_data1","_data2","_data2f","_data2t"],CONTROL:["_x","_y","_w","_h","_size","_scalef","_scalet","_number","_number_x","_number_y"],TABPAGE:["_scalef","_scalet","_midi_channel","_midi_type","_midi_data1","_midi_data2","_midi_data2f","_midi_data2t"],LAYOUT:["_version","_mode","_w","_h"]},h={CONTROL:["_inverted_x","_inverted_y","_centered","_inverted","_background","_outline","_local_off","_norollover","_ex_mode","_seconds"]},g="_velocity",m="_velocity_invert";return{sanitizeJsonAfterImport:c,sanitizeJsonForExport:f}}),define("AMD/LayoutHolder",["knockout","underscore","util","LOG","AMD/VisualConfig","AMD/file/JsonSanitizer"],function(e,t,n,i,r,o){"use strict";function a(){var n=this,i=r.getInstance(),a=e.observable();this.json=e.computed({read:a,write:function(e){i.zoomReset(),a(e)}}),this.getJsonForExport=function(){var e=n.json.peek(),i=e&&JSON.parse(JSON.stringify(e));return i&&(t.each(i.layout.tabpage,function(e){t.each(e.control,function(t,n){e.control[n]=t.props})}),o.sanitizeJsonForExport(i)),i||null},this.hasLayout=e.computed(function(){return!!n.json()}),this.layout=e.computed(function(){return n.json()&&n.json().layout}),this.tabPages=e.computed(function(){var e=n.layout();return e&&e.tabpage}),this.forEachControl=function(e){var i=n.json.peek();t.chain(i&&i.layout&&i.layout.tabpage).pluck("control").flatten().each(e)},this.forEachTabPage=function(e){var i=n.json.peek();t.each(i&&i.layout&&i.layout.tabpage,e)},this.needsRedraw=e.observable(!0).extend({notify:"always"}),this.triggerRedraw=function(){n.needsRedraw(!1),n.needsRedraw(!0)}}var s;return{getInstance:function(){return s||(s=new a),s}}}),define("AMD/ControlSelection",["knockout","underscore","util","LOG","AMD/control/ControlSupport","koToggleableExtender"],function(e,t,n,i,r){"use strict";function o(){var o=this,a=function(e,i){var a=t.flatten([e]),s=t.every(a,r.isControl);return n.assert(s,"Invalid controlOrControls for ControlSelection: {}",e),i&&o.ignoreLabels.peek()?t.reject(a,r.isLabel):a};this.ignoreLabels=e.observable(!0).extend({toggleable:!0}),this.ignoreLabels.subscribe(function(e){if(e){var n=o.controls.peek(),i=n.length,a=t.reject(n,r.isLabel);a.length!==i&&o.controls(a)}}),this.controls=e.observableArray().extend({deferred:!0}),this.isLocked=e.observable(!1).extend({toggleable:!0}),this.reset=function(){o.controls.peek().length?(o.controls.removeAll(),i.debug("ControlSelection cleared")):i.debug("ControlSelection was empty already"),o.isLocked.toggleOff()},this.select=function(e){if(!o.isLocked()){var n=a(e,!0),i=o.controls.peek(),r=t.some(n,function(e){return i.indexOf(e)<0});r&&o.controls(t.union(i,n))}},this.unselect=function(e){if(!o.isLocked()){var n=a(e),i=t.intersection(o.controls.peek(),n);i.length&&o.controls.removeAll(i)}},this.toggleSelected=function(e){if(!o.isLocked()){var n=a(e),i=o.controls.peek(),r=t.partition(n,function(e){return i.indexOf(e)>=0});t.each(r[0],o.unselect),t.each(r[1],o.select)}},this.setAllowedControls=function(e){var n=t.difference(o.controls.peek(),e);n.length&&o.unselect(n)},this.isControlSelected=function(e){return o.controls().indexOf(e)>=0},this.forEachControl=function(e){t.each(o.controls(),e)}}var a;return{getInstance:function(){return a||(a=new o),a}}}),define("AMD/VisualMode",["knockout","LOG","util","underscore","jquery","AMD/ControlFilter","AMD/VisualConfig","AMD/LayoutHolder","AMD/ControlSelection"],function(e,t,n,i,r,o,a,s,u){"use strict";function l(){var n=this,l=o.getInstance(),c=s.getInstance(),d=u.getInstance(),f=!1,p=!1,h=0,g=0,m=function(){var e={left:0,top:0},t=void 0!==window.pageXOffset,n=!t&&(document.documentElement||document.body.parentNode||document.body);return r(window).on("scroll",function(){e.left=t?window.pageXOffset:n.scrollLeft,e.top=t?window.pageYOffset:n.scrollTop}),e}(),v={RECT_MOUSEOVER:function(t){var i=n.config.isTooltipEnabled()&&e.dataFor(t.target);i&&i&&i.typeName&&n.controlTooltip(i)},RECT_MOUSEOUT:function(){n.controlTooltip(null)},SVG_MOUSEDOWN_OR_MOVE:function(i){var o=i.type.indexOf("move")<0,a=i.originalEvent.touches,s=a?i.originalEvent.touches[0]:i,u=o&&(""+s.target.className.baseVal).indexOf("svg__tab")>=0,l=s.pageX+(a?m.left:0),c=s.pageY+(a?m.top:0);if(u)return void t.dev("Touch on Tab -> returning");if(i.preventDefault(),n.config.isTooltipEnabled()&&n.controlTooltip()&&r("#controlTooltip").css({left:s.clientX+40+"px",top:s.clientY-80+"px"}),!p){if(o)f=!0,h=l,g=c;else if(!f)return!1;var v=Math.min(h,l),b=Math.max(h,l),y=Math.min(g,c),_=Math.max(g,c);return r(this).find(".svg__selectable").each(function(){var t=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0,n=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,i=this.parentNode.getBoundingClientRect(),r=i.left+t,a=i.right+t,u=i.top+n,l=i.bottom+n,c=r<=v&&a>=v||r<=b&&a>=b||r>=v&&a<=b||r<=v&&a>=b,f=u<=y&&l>=y||u<=_&&l>=_||u>=y&&l<=_||u<=y&&l>=_,p=e.dataFor(this);c&&f?o&&s.ctrlKey?d.toggleSelected(p):d.select(p):s.ctrlKey||d.unselect(p)}),!1}},BODY_MOUSEUP:function(){f=!1}},b=function(){d.isLocked.subscribe(function(e){p=e}),r(document.body).on("mouseover",".svg__root *",v.RECT_MOUSEOVER),r(document.body).on("mouseout",".svg__root *",v.RECT_MOUSEOUT),r(document.body).on("mousedown touchstart",".svg__root",v.SVG_MOUSEDOWN_OR_MOVE),r(document.body).on("mousemove touchmove",".svg__root",v.SVG_MOUSEDOWN_OR_MOVE),r(document.body).on("mouseup touchend",v.BODY_MOUSEUP)};this.config=a.getInstance(),this.controlTooltip=e.observable(),this.isEnabled=e.computed(function(){return!!c.json()}),this.currentTabPage=e.observable(0),c.tabPages.subscribe(function(e){n.currentTabPage(e&&e.length?e[0]:null)}),this.visibleControlsInCurrentTab=e.pureComputed(function(){var e=n.currentTabPage(),t=e&&i.filter(e.control,l.isControlVisible);return d.setAllowedControls(t||[]),t}),b()}return l}),define("AMD/edit/PropertyEditor",["knockout","underscore","util","LOG","AMD/control/ControlSupport","AMD/ControlSelection","koToggleableExtender"],function(e,t,n,i,r,o){"use strict";function a(){function a(e){var t=u.propInfo(),n=!1,i=null;return t&&null!==e?(t.isString?(i=$.trim(e),"_osc_cs"===g&&i?(i=i.replace(/^\/*/,"/").replace(/\/*$/,""),n=l._osc_cs.OSC_PATH_REGEX.test(i)):n=!!i||!t.nonempty):t.isNumber?(i=parseInt(e,10),n=c.test(e)&&"number"==typeof i&&!isNaN(i)&&i>=t.min&&i<=t.max):t.isColor&&(i=e,n=u.colorOptions.indexOf(i)>=0),n?i:null):null}function s(){t.some(v.controls(),function(e){var t=e.props[g];if("undefined"==typeof t)return!1;var n=u.propInfo();if(n.isNumber&&"number"==typeof t)u.newValue(t),u.counterStart(t);else if(n.isString&&"string"==typeof t)if(/^(.*?)(\d*)$/.test(t)){var i=RegExp.$1,r=RegExp.$2;r?(u.useCounter(!0),u.counterStart(parseInt(r,10)),u.newValue(i+h)):u.newValue(i)}else u.newValue(t);return!0})}var u=this,g=null,m=null,v=o.getInstance();this.useCounter=e.observable(!1).extend({toggleable:!0}),this.counterStart=e.observable(),this.counterStep=e.observable(),this.counterStepOptions=t.range(1,21),this.counterDigits=e.observable(),this.counterDigitsOptions=t.range(1,6),this.needsCompleteRedraw=e.observable(!0).extend({notify:"always"}),this.tableNeedsRedraw=e.observable(!0).extend({notify:"always"}),this.triggerTableRedraw=function(){u.tableNeedsRedraw(!1),u.tableNeedsRedraw(!0)},this.newValue=e.observable(),this.propInfo=e.observable(),this.isVisible=this.propInfo,this.isMultiEditMode=e.observable(!1),this.isPreviewEnabled=e.observable(!1).extend({toggleable:!0}),this.useCounter.subscribe(function(e){if(u.propInfo()){var t=""+u.newValue.peek(),n=t.indexOf(h)>=0,i=e&&!n?t+h:!e&&n?t.replace(h,""):t;u.propInfo().isNumber&&e&&(i=h),i!==t&&u.newValue(i)}}),this.useCounterAsValue=e.pureComputed(function(){return u.propInfo()&&u.useCounter()&&u.propInfo().isNumber}),this.submittableValue=e.computed(function(){var e=u.newValue(),t=m&&g&&null!==e;return t?a(e):null}),this.submittableValueMap=e.pureComputed(function(){var e=""+u.newValue(),i={},r=u.useCounter(),o=r?c.test(u.counterStart())&&parseInt(u.counterStart(),10):0,s="number"==typeof o&&!isNaN(o),l=r?u.counterStep():1,d=u.counterDigits(),f=u.useCounterAsValue(),p=s&&t.every(v.controls(),function(t){if("undefined"!=typeof t.props[g]){var s=f?o:r?e.replace(h,n.paddLeft(o,d)):e,u=a(s);if(null===u)return!1;i[t.uid]=u,o+=l}return!0});return p&&i||null}),this.editSingleControl=function(e,t){n.assertString(!!t&&t,"Invalid propName for PropertyEditor.editSingleProperty"),u.reset();var r=e&&e.props,o=r&&"undefined"!=typeof r[t],a=o&&r[t],s=o&&l[t]||null;o?"boolean"==typeof a?(r[t]=!a,u.reset(),u.needsCompleteRedraw(!0)):"string"==typeof a&&"_response"===t?(r._response="absolute"===a?"relative":"absolute",u.needsCompleteRedraw(!0)):"string"==typeof a&&"_type"===t&&0===a.indexOf("rotary")?(e.setType("rotaryv"===a?"rotaryh":"rotaryv"),u.needsCompleteRedraw(!0)):s?(u.newValue(e.props[t]),g=t,m=e):i.debug('PropertyEditor cannot handle property "%s"',t):i.warn('Cannot edit property "%s" of control %o',t,e),u.newValue.valueHasMutated(),u.propInfo(s)},v.controls.subscribe(function(e){e.length||u.reset()}),this.editMultipleControls=function(e){n.assertString(!!e&&e,"Invalid propName for PropertyEditor.editSingleProperty"),u.reset();var t=l[e]||null,i=null;t?(u.isMultiEditMode(!0),g=e,u.newValue(""),u.propInfo(t),t.enablePreview&&u.isPreviewEnabled(!0),s()):(v.forEachControl(function(t){var n=t.props;"boolean"==typeof n[e]?(null===i&&(i=!n[e]),n[e]=i):"_response"===e&&"string"==typeof n[e]&&(null===i&&(i="absolute"===n[e]?"relative":"absolute"),n[e]=i)}),null!==i&&u.needsCompleteRedraw(!0))},this.reset=function(){u.propInfo(null),g=null,m=null,u.counterStart(d),u.counterDigits(p),u.counterStep(f),u.useCounter(!1),u.isPreviewEnabled(!1),u.isMultiEditMode(!1)},this.canSubmit=e.computed(function(){return u.isMultiEditMode()?null!==u.submittableValueMap():null!==u.submittableValue()}),this.isEditedMultiProperty=function(e){return u.isVisible()&&u.isMultiEditMode()&&e===g},this.isEditedControlAndProperty=function(e,t){return u.isVisible()&&e===m&&g===t},this.submit=function(){if(!u.canSubmit())return void i.warn("Cant submit now");var e=u.propInfo(),n=e.redrawOnSubmit,r=!1,o=e.isColor;if(u.isMultiEditMode()){var a=u.submittableValueMap();v.forEachControl(function(e){var t=a[e.uid];null!==t&&(i.debug('Updating property "%s" of control %o with value %o',g,e,t),e.props[g]=t,o?e.updateColorCode():r=!0,e.finalizePropertyEdit())})}else m.props[g]=u.submittableValue(),o&&m.updateColorCode(),m.finalizePropertyEdit();n?t.defer(function(){u.needsCompleteRedraw(!0)}):r&&u.triggerTableRedraw(),u.reset()},this.colorOptions=r.ALL_COLORS,this.setColor=function(e){e&&(u.newValue(e),t.defer(u.submit))},this.onKeyup=function(e,t){t&&27===event.keyCode&&u.reset()}}var s,u={isNumber:!0,min:-16777216,max:16777216},l={_name:{isString:!0,nonempty:!0,enablePreview:!0},_osc_cs:{isString:!0,OSC_PATH_REGEX:/^\/.*[^\/]$/},_text:{isString:!0,redrawOnSubmit:!0,enablePreview:!0},_scalef:u,_scalet:u,_size:{isNumber:!0,min:1,max:50,redrawOnSubmit:!0},_color:{isColor:!0,redrawOnSubmit:!0}},c=/^-?\d+$/,d=0,f=1,p=1,h="%C";return{getInstance:function(){return s||(s=new a),s}}}),define("AMD/knockout/koValidIntOrNullExtender",["knockout"],function(e){"use strict";e.extenders.validIntOrNull=function(){var t=/^-?[0-9]+?$/,n=function(e,t,n){return e>=t&&e<=n},i=function(e,t,n){return e>=t},r=function(e,t,n){return e<=n};return function(o,a){var s=a&&"number"==typeof a.min,u=a&&"number"==typeof a.max,l=s&&u?n:s?i:u?r:null;return o.validIntOrNull=e.computed(function(){var e=o(),n=t.test(""+e)&&parseInt(e,10),i="number"==typeof n&&(!l||l(n,a.min,a.max));return i?n:i}),o}}()}),define("AMD/edit/MidiEditor",["knockout","underscore","util","LOG","AMD/midi/MidiUtil","AMD/midi/MessageTypes","AMD/ControlSelection","AMD/knockout/koValidIntOrNullExtender","koToggleableExtender"],function(e,t,n,i,r,o,a){"use strict";function s(){var n=this,s=e.observable(),u=a.getInstance(),f=o.CC;this.isPreviewEnabled=e.observable(!1).extend({toggleable:!0}),this.tableNeedsRedraw=e.observable(!0).extend({notify:"always"}),this.isNoteNamesEnabled=e.observable(!1).extend({toggleable:!0}),this.triggerTableRedraw=function(){n.tableNeedsRedraw(!1),n.tableNeedsRedraw(!0)},this.canRemoveMidi=e.observable(!1),this.isRemoveConfirmed=e.observable(!1).extend({toggleable:!0}),this.mode=e.observable(c),this.mode.subscribe(function(e){if(e.aspect){var t=e.singleControl&&e.singleControl.getValueForMidiVar(e.singleVar),i=t&&o.byId[t._type]||o.CC;e.isMultiEdit&&n.isPreviewEnabled(!0),n.isRemoveConfirmed(!1),t?(n.channel(t._channel),n.data1(t._data1),n.data2f(t._data2f),n.data2t(t._data2t),n.sysex(t._sysex||""),n.messageType(i),n.canRemoveMidi(!0)):(n.resetMidiVars(),n.canRemoveMidi(e.isMultiEdit))}}),this.defaultMidiChannel=e.observable(1),this.midiChannelOptions=t.range(1,17),this.resetMidiVars=function(){n.isRemoveConfirmed(!1),n.channel(n.defaultMidiChannel()),n.data1(f.data1Min),n.data2f(f.data2fMin),n.data2t(f.data2tMax),n.sysex(""),n.messageType(f),n.includeChannel(!0),n.includeData1(!0),n.includeData2f(!0),n.includeData2t(!0)},this.messageTypeOptions=e.computed(function(){if(!n.mode().aspect)return null;var e,t=n.mode(),i=t.singleControl,r=t.isValue?"valueTypes":t.isTouch?"touchTypes":t.isColor?"colorTypes":null;return t.isSingleEdit&&i?e=i[r]:t.isMultiEdit&&(e=o.forMidiMultiEdit),e||[]}),this.isEditedControlVar=function(e,t){var i=n.mode();return i.singleControl===t&&i.singleVar===e},this.editSingle=function(e,t){n.mode(d(null,e,t))},this.editMultiValue=function(){n.mode(d(l.VALUE,null,null))},this.editMultiTouch=function(){n.mode(d(l.TOUCH,null,null))},this.editMultiColor=function(){n.mode(d(l.COLOR,null,null))},this.messageType=e.observable(),this.channel=e.observable().extend({validIntOrNull:{min:1,max:16}}),this.data1=e.observable().extend({validIntOrNull:!0}),this.data2f=e.observable().extend({validIntOrNull:!0}),this.data2t=e.observable().extend({validIntOrNull:!0}),this.sysex=e.computed({read:s,write:function(e){s((e||"").replace(/\s/g,"").toUpperCase())}}),this.includeChannel=e.observable(!0).extend({toggleable:!0}),this.includeData1=e.observable(!0).extend({toggleable:!0}),this.includeData2f=e.observable(!0).extend({toggleable:!0}),this.includeData2t=e.observable(!0).extend({toggleable:!0}),this.includeAll=e.computed(function(){return n.includeChannel()&&n.includeData1()&&n.includeData2f()&&n.includeData2t()}),this.messageType.subscribe(function(e){if(e){var t=n.mode(),i=n.channel.validIntOrNull()||0,r=n.data1.validIntOrNull()||0,o=n.data2f.validIntOrNull()||0,a=n.data2t.validIntOrNull()||0;n.channel(Math.max(e.channelMin,Math.min(i,e.channelMax))),n.data1(Math.max(e.data1Min,Math.min(r,e.data1Max))),n.data2f(Math.max(e.data2fMin,Math.min(o,e.data2fMax))),n.data2t(Math.max(e.data2tMin,Math.min(a,e.data2tMax))),t.isMultiEdit&&(e.hasFixChannel&&n.autoIncChannel(0),e.hasFixData1&&n.autoIncData1(0),e.hasFixData2f&&n.autoIncData2f(0),e.hasFixData2t&&n.autoIncData2t(0)),e.sysex||n.sysex("")}}),this.isMessageTypeNote=e.pureComputed(function(){return n.messageType()===o.NOTE}),this.autoIncOptions=t.range(-3,4),this.autoIncChannelOptions=t.range(-1,2),this.formatAutoIncOption=function(e){return e?e>0?"+"+e:e:"fix"},this.autoIncChannel=e.observable(!1).extend({toggleable:!0}),this.autoIncData1=e.observable(!1).extend({toggleable:!0}),this.autoIncData2f=e.observable(!1).extend({toggleable:!0}),this.autoIncData2t=e.observable(!1).extend({toggleable:!0}),this.midiOrPreviewString=function(e,t){
if(n.isPreviewEnabled()){var i=n.submittableMidiObjectMap(),o=i&&i[e.uid],a=o&&o[t];return a?r.midiJsonToString(a,n.isNoteNamesEnabled()):"-"}return e.getValueStringForMidiVar(t,n.isNoteNamesEnabled())},this.reset=function(){n.mode(c),n.isPreviewEnabled(!1),n.resetMidiVars()},this.submittableMidiObjectMap=e.computed(function(){var e=n.mode(),i=e&&e.isMultiEdit&&n.messageType();if(!i)return null;var r={},o=n.channel.validIntOrNull(),a=n.data1.validIntOrNull(),s=n.data2f.validIntOrNull(),l=n.data2t.validIntOrNull(),c=n.sysex(),d=n.includeAll(),f=n.includeData1(),p=n.includeData2f(),h=n.includeData2t(),g=n.includeChannel(),m=!(g||f||p||h),v=g?n.autoIncChannel():0,b=f?n.autoIncData1():0,y=p?n.autoIncData2f():0,_=h?n.autoIncData2t():0,M=!d;if(null===o||null===a||null===s||null===l||m)return null;try{t.each(u.controls(),function(n){var u=n.getMidiVarNamesByAspect(e.isValue,e.isTouch,e.isColor);r[n.uid]=t.reduce(u,function(e,t){var r,u=M&&n.getValueForMidiVar(t),d=u&&u._type===i.id;if(M){if(!u)return e;r=d?i.createValidControlMidiObject(t,g?o:u._channel,f?a:u._data1,p?s:u._data2f,h?l:u._data2t,u._sysex||""):u}else r=i.createValidControlMidiObject(t,o,a,s,l,c);if(!r)throw"invalid midiObj";return o+=v,a+=b,s+=y,l+=_,e[t]=r,e},{})})}catch(e){r=null}return r}),this.submittableMidiObject=e.computed(function(){var e=n.mode(),t=e.isSingleEdit&&n.messageType(),i=t&&t.createValidControlMidiObject(e.singleVar,n.channel.validIntOrNull(),n.data1.validIntOrNull(),n.data2f.validIntOrNull(),n.data2t.validIntOrNull(),n.sysex());return i||null}),this.canSubmit=e.computed(function(){var e=n.mode();return!!(e.isSingleEdit?n.submittableMidiObject():!!e.isMultiEdit&&n.submittableMidiObjectMap())}),this.removeMidi=function(){if(n.canRemoveMidi()){if(!n.isRemoveConfirmed())return void n.isRemoveConfirmed(!0);var e=n.mode();e.isSingleEdit?(e.singleControl.removeMidiVar(e.singleVar),e.singleControl.finalizePropertyEdit()):e.isMultiEdit&&u.forEachControl(function(t){t.removeAllMidiByAspect(e.isValue,e.isTouch,e.isColor),t.finalizePropertyEdit()}),n.triggerTableRedraw(),n.reset()}},this.submit=function(){if(!n.canSubmit())return void i.dev("Cannot submit MidiEditor now");var e=!1,r=n.mode(),o=r.isMultiEdit&&n.submittableMidiObjectMap();o?(u.forEachControl(function(e){t.each(o[e.uid],function(t){e.setMidi(t),e.finalizePropertyEdit()})}),e=!0):r.isSingleEdit&&(r.singleControl.setMidi(n.submittableMidiObject()),r.singleControl.finalizePropertyEdit(),e=!0),e&&n.triggerTableRedraw(),n.reset()}}var u=null,l={VALUE:"VALUE",TOUCH:"TOUCH",COLOR:"COLOR"},c={},d=function(e,t,i){n.assertObjectOrEmpty(i,"Invalid singleControl: {}",i),n.assertStringOrEmpty(t,"Invalid singleVar: {}",t),n.assert(!i==!t,"Invalid combination of singleControl and singleVar"),n.assert(!e||l[e],'Invalid aspect "{}"',e),n.assert(e||i,"Either aspect or control is required");var r=e||(i.valueVars.indexOf(t)>=0?l.VALUE:i.touchVars.indexOf(t)>=0?l.TOUCH:i.colorVars.indexOf(t)>=0?l.COLOR:null),o={singleControl:i,singleVar:t,isSingleEdit:!!i,isMultiEdit:!i,aspect:r,isValue:r===l.VALUE,isTouch:r===l.TOUCH,isColor:r===l.COLOR};return n.assert(o.aspect,"Unable to determine aspect for new MidiEditor EditorMode"),o.isMultiEditValue=o.isMultiEdit&&o.isValue,o.isMultiEditTouch=o.isMultiEdit&&o.isTouch,o.isMultiEditColor=o.isMultiEdit&&o.isColor,o};return{getInstance:function(){return u||(u=new s),u}}}),define("AMD/edit/ControlEditor",["knockout","util","LOG","jquery","underscore","AMD/control/ControlSupport","AMD/ControlSelection","AMD/LayoutHolder","AMD/edit/PropertyEditor","AMD/edit/MidiEditor","koToggleableExtender"],function(e,t,n,i,r,o,a,s,u,l){"use strict";function c(){var n=this,c=s.getInstance(),d=e.pureComputed(function(){return r.chain(n.selection.controls()).pluck("props").map(r.keys).flatten().unique().reject(n.isTabPageMode()?g:p).reject(n.isNonBasicVisible()?t.NOP:m).reject(n.isOscVisible()?t.NOP:h).sortBy(b).value().join(",")}).extend({rateLimit:50});this.tabPageControlAdapters=e.computed(function(){return r.map(c.tabPages(),o.createControlAdapterByTabPageJson)}),this.selection=a.getInstance(),this.isVisible=e.observable(!1).extend({toggleable:!0}),this.isOpen=e.observable(!0).extend({toggleable:!0}),this.isOscVisible=e.observable(!1).extend({toggleable:!0}),this.isMidiVisible=e.observable(!0).extend({toggleable:!0}),this.isNonBasicVisible=e.observable(!0).extend({toggleable:!0}),this.isHighlighterEnabled=e.observable(!1).extend({toggleable:!0}),this.isTabPageMode=e.observable(!1).extend({toggleable:!0}),this.isTabPageMode.subscribe(function(e){n.selection.reset(),e&&(n.selection.reset(),r.defer(function(){n.selection.select(n.tabPageControlAdapters()),n.selection.isLocked.toggleOn(),n.isOpen.toggleOn()}))}),this.controlProperties=e.pureComputed(function(){return d().split(",")}).extend({rateLimit:30}),this.propertyEditor=u.getInstance(),this.propertyEditor.needsCompleteRedraw.subscribe(c.triggerRedraw),this.tableNeedsRedraw=e.observable(!0).extend({notify:"always"}),this.propertyEditor.tableNeedsRedraw.subscribe(this.tableNeedsRedraw),this.midiEditor=l.getInstance(),this.midiEditor.tableNeedsRedraw.subscribe(this.tableNeedsRedraw),this.onBodyCellClick=function(t,r){var o=r.target,a=o&&"TD"===o.nodeName;if(a&&/controlEditor__unselectCell/.test(o.className))n.selection.unselect(e.dataFor(o));else if(!a&&i(o).closest(".controlEditor__midiVal").length){var s=e.contextFor(o),u=s.$data,l=s.$parent;n.midiEditor.editSingle(u,l)}else{var c=a&&e.dataFor(o),d="string"==typeof c,f=d&&e.dataFor(o.parentNode);f&&n.propertyEditor.editSingleControl(f,c)}return!0},this.reset=function(){n.isTabPageMode.toggleOff(),n.midiEditor.reset()},this.isEmpty=e.computed(function(){var e=!n.selection.controls().length;return e}),c.layout.subscribe(this.reset)}var d=null,f=["_type","_name","_color","_scalef","_scalet","_osc_cs"],p=function(e){return 2===e.length||"_"!==e.charAt(0)},h=function(e){return"_scalef"===e||"_scalet"===e||"_osc_cs"===e},g=function(e){return"_type"===e||"_"!==e.charAt(0)},m=function(e){return f.indexOf(e)<0},v={_type:2,_name:1,_color:3,_scalef:31,_scalet:32,_osc_cs:33},b=function(e){return v[e]||1e4};return{getInstance:function(){return d||(d=new c),d}}}),define("AMD/Dimensions",["knockout","LOG","util","AMD/VisualConfig","AMD/LayoutHolder"],function(e,t,n,i,r){"use strict";function o(){var t=this,n=i.getInstance(),o=r.getInstance();this.layoutWidth=e.observable().extend({deferred:!0}),this.layoutHeight=e.observable().extend({deferred:!0}),this.isLandscape=e.observable(),this.scaled=e.observable().extend({deferred:!0}),e.computed(function(){if(o.layout()){var e=o.layout(),i=e._w&&e._h?{name:"custom",w:e._w,h:e._h}:s[e._mode]||s.default,r="vertical"===e._orientation,a=Math.min(i.w,i.h),u=Math.max(i.w,i.h),l=n.zoom();t.isLandscape(r),t.layoutWidth(a),t.layoutHeight(u),t.scaled({width:Math.round(a*l),height:Math.round(u*l)})}})}var a,s={0:{name:"iphone",w:320,h:480},1:{name:"ipad",w:768,h:1024},2:{name:"iphone5",w:320,h:568},3:{name:"ipadpro",w:1024,h:1366},8:{name:"ipad",w:768,h:1024},default:{name:"unknwon",w:320,h:480}};return{getInstance:function(){return a||(a=new o),a}}}),define("AMD/EncodingCheck",["knockout","underscore","util","LOG","AMD/LayoutHolder","AMD/control/ControlSupport","AMD/edit/ControlEditor","AMD/edit/PropertyEditor"],function(e,t,n,i,r,o,a,s){"use strict";function u(t,i){n.assertNonEmptyString(t,"Invalid propName for SuspiciousProperty"),n.assertObject(i,"Invalid property name");var r=i.props[t],a=o.isTabPageControlAdapter(i);this.isTabPageControlAdapter=a,this.controlOrTabPageAdapter=i,this.typeName=a?"Tab Page":i.typeName,this.propName=t,this.originalValue=r,this.fixes=this.getFixSuggestionsForString(r),this.valueToUse=e.observable(r),this.isApplied=!1}function l(){var n=this,i=e.observableArray();this.isAvailable=r.getInstance().hasLayout,this.maxFixColumns=0,this.suspiciousProperties=e.computed(function(){return t.filter(i(),{isApplied:!1})}),this.fixedProperties=e.computed(function(){return t.filter(i(),{isApplied:!0})}),e.computed(function(){var e=[];n.isAvailable()&&(t.each(a.getInstance().tabPageControlAdapters(),function(t){u.pushIfSuspicious(t,"_name",e),u.pushIfSuspicious(t,"_osc_cs",e)}),r.getInstance().forEachControl(function(t){u.pushIfSuspicious(t,"_name",e),u.pushIfSuspicious(t,"_osc_cs",e),u.pushIfSuspicious(t,"_text",e)})),n.maxFixColumns=t.reduce(e,function(e,t){return Math.max(t.fixes.length,e)},0),i(e)}),this.onClick=function(t,n){var i=e.contextFor(n.target),r=i&&"string"==typeof i.$data&&i.$data,o=i&&i.$parent,a=r&&o instanceof u;a&&o.valueToUse(r)},this.applySelectedFixes=function(){t.each(n.suspiciousProperties(),function(e){e.applySelectedFix()}),i.valueHasMutated(),t.defer(function(){s.getInstance().triggerTableRedraw()})}}var c,d=/[^\-+a-z0-9\/_\. \:#<>öäüß]/i;return u.prototype={fixFunctions:[function(e){return n.decodeBase64(e)},function(e){return decodeURIComponent(escape(e))},function(e){return decodeURIComponent(escape(decodeURIComponent(escape(e))))},function(e){return decodeURIComponent(escape(n.decodeBase64(e)))},function(e){return btoa(e)}],getFixSuggestionsForString:function(e){return t.chain(this.fixFunctions).map(function(t,n){var i;try{i=t(e)}catch(t){i=e}return i}).unique().without(e).value()},applySelectedFix:function(){var e=this.valueToUse();e!==this.originalValue&&(this.controlOrTabPageAdapter.props[this.propName]=e,this.controlOrTabPageAdapter.finalizePropertyEdit(),i.dev('Applied fixed value "%s" on property "%s" of %s %o',e,this.propName,this.typeName,this.controlOrTabPageAdapter),this.isApplied=!0)}},u.pushIfSuspicious=function(e,t,n){var i=e.props[t],r=i&&d.test(""+i);r&&n.push(new u(t,e))},{getInstance:function(){return c||(c=new l),c}}}),define("AMD/file/SourceFileHolder",["knockout","underscore","jquery","LOG","util","zip","AMD/file/JsonXmlConverter","AMD/file/JsonSanitizer","AMD/control/ControlSupport"],function(e,t,n,i,r,o,a,s,u){"use strict";function l(){var r=this,l=a.getInstance(),c=e.observable();this.file=e.computed({read:c,write:function(e){e&&c(e)}}),this.xml=e.observable().extend({deferred:!0}),this.error=e.observable().extend({deferred:!0}),this.encodingInfo=e.observable(),this.file.subscribe(function(e){r.xml(""),r.error("");var a=n(d)[0].files[0];return a?void o.createReader(new o.BlobReader(a),function(e){e.getEntries(function(n){var a=t.find(n,function(e){return!e.directory&&/(^|\/)index.xml$/.test(e.filename)});a?a.getData(new o.TextWriter,function(t){r.xml(t),e.close(function(){i.dev("zipReader closed.")})},function(e,t){}):(r.error("No index.xml found"),e.close(function(){i.dev("zipReader closed.")}))})},function(e){r.error(e),i.error(e)}):void r.error("Please select a file.")}),this.sanitizedJson=e.pureComputed(function(){var e=r.xml(),n=e&&l.xml2json(e);return n&&e&&(r.encodingInfo({namesNeedDecoding:/ name="[a-z0-9\-]+={1,2}"/i.test(e),textsNeedDecoding:/ text="[a-z0-9\-]+={1,2}"/i.test(e)}),s.sanitizeJsonAfterImport(n,r.encodingInfo.peek()),t.each(n.layout.tabpage,function(e){e.control=t.map(e.control,u.createControlByJson)})),n})}var c,d="#touchosc__file";return{getInstance:function(){return c||(c=new l),c}}}),!function(e,t){"function"==typeof define&&define.amd?define("knockoutFastForeach",["knockout"],t):"object"==typeof exports?module.exports=t(require("knockout")):e.KnockoutFastForeach=t(e.ko)}(this,function(e){"use strict";function t(e){return!!e&&"object"==typeof e&&e.constructor===Object}function n(e){return 8===e.nodeType&&c.test(l?e.text:e.nodeValue)}function i(t){var n,i=document.createElement("div");return t.content?n=t.content:"SCRIPT"===t.tagName?(n=document.createElement("div"),n.innerHTML=t.text):n=t,e.utils.arrayForEach(e.virtualElements.childNodes(n),function(e){e&&i.insertBefore(e.cloneNode(!0),null)}),i}function r(e,t){return{status:"added",value:e,index:t}}function o(e){return"function"==typeof Symbol?Symbol(e):e}function a(t){this.element=t.element,this.container=n(this.element)?this.element.parentNode:this.element,this.$context=t.$context,this.data=t.data,this.as=t.as,this.noContext=t.noContext,this.noIndex=t.noIndex,this.afterAdd=t.afterAdd,this.beforeRemove=t.beforeRemove,this.templateNode=i(t.templateNode||(t.name?document.getElementById(t.name).cloneNode(!0):t.element)),this.afterQueueFlush=t.afterQueueFlush,this.beforeQueueFlush=t.beforeQueueFlush,this.changeQueue=[],this.firstLastNodesList=[],this.indexesToDelete=[],this.rendering_queued=!1,this.pendingDeletes=[],e.virtualElements.emptyNode(this.element);var o=e.unwrap(this.data);o.map&&this.onArrayChange(o.map(r)),e.isObservable(this.data)&&(this.data.indexOf||(this.data=this.data.extend({trackArrayChanges:!0})),this.changeSubs=this.data.subscribe(this.onArrayChange,this,"arrayChange"))}function s(t){t.$index=e.observable()}var u=9007199254740991,l=document&&"<!--test-->"===document.createComment("test").text,c=l?/^<!--\s*ko(?:\s+([\s\S]+))?\s*-->$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,d=document&&"function"==typeof document.createDocumentFragment,f=o("_ko_ffe_pending_delete_index");a.PENDING_DELETE_INDEX_KEY=f,a.animateFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)},a.prototype.dispose=function(){this.changeSubs&&this.changeSubs.dispose(),this.flushPendingDeletes()},a.prototype.onArrayChange=function(e){for(var t=this,n={added:[],deleted:[]},i=0,r=e.length;r>i;i++){if(n.added.length&&"added"==e[i].status){var o=n.added[n.added.length-1],s=o.isBatch?o.index+o.values.length-1:o.index;if(s+1==e[i].index){o.isBatch||(o={isBatch:!0,status:"added",index:o.index,values:[o.value]},n.added.splice(n.added.length-1,1,o)),o.values.push(e[i].value);continue}}n[e[i].status].push(e[i])}n.deleted.length>0&&(this.changeQueue.push.apply(this.changeQueue,n.deleted),this.changeQueue.push({status:"clearDeletedIndexes"})),this.changeQueue.push.apply(this.changeQueue,n.added),this.changeQueue.length>0&&!this.rendering_queued&&(this.rendering_queued=!0,a.animateFrame.call(window,function(){t.processQueue()}))},a.prototype.processQueue=function(){var t=this,n=u;"function"==typeof this.beforeQueueFlush&&this.beforeQueueFlush(this.changeQueue),e.utils.arrayForEach(this.changeQueue,function(e){"number"==typeof e.index&&(n=Math.min(n,e.index)),t[e.status](e)}),this.flushPendingDeletes(),this.rendering_queued=!1,this.noIndex||this.updateIndexes(n),"function"==typeof this.afterQueueFlush&&this.afterQueueFlush(this.changeQueue),this.changeQueue=[]},a.prototype.added=function(t){for(var n=t.index,i=t.isBatch?t.values:[t.value],r=this.getLastNodeBeforeIndex(n),o=[],a=0,u=i.length;u>a;++a){var l,c=this.getPendingDeleteFor(i[a]);if(c&&c.nodesets.length)l=c.nodesets.pop();else{var d,f=this.templateNode.cloneNode(!0);d=this.noContext?this.$context.extend({$item:i[a],$index:this.noIndex?void 0:e.observable()}):this.$context.createChildContext(i[a],this.as||null,this.noIndex?void 0:s),e.applyBindingsToDescendants(d,f),l=e.virtualElements.childNodes(f)}o.push.apply(o,Array.prototype.slice.call(l)),this.firstLastNodesList.splice(n+a,0,{first:l[0],last:l[l.length-1]})}"function"==typeof this.afterAdd?this.afterAdd({nodeOrArrayInserted:this.insertAllAfter(o,r),foreachInstance:this}):this.insertAllAfter(o,r)},a.prototype.getNodesForIndex=function(e){var t=[],n=this.firstLastNodesList[e].first,i=this.firstLastNodesList[e].last;for(t.push(n);n&&n!==i;)n=n.nextSibling,t.push(n);return t},a.prototype.getLastNodeBeforeIndex=function(e){return 1>e||e-1>=this.firstLastNodesList.length?null:this.firstLastNodesList[e-1].last},a.prototype.insertAllAfter=function(t,n){var i,r,o,a=this.element;if(void 0===t.nodeType&&void 0===t.length)throw new Error("Expected a single node or a node array");if(void 0!==t.nodeType)return e.virtualElements.insertAfter(a,t,n),[t];if(1===t.length)e.virtualElements.insertAfter(a,t[0],n);else if(d){for(i=document.createDocumentFragment(),o=0,r=t.length;o!==r;++o)i.appendChild(t[o]);e.virtualElements.insertAfter(a,i,n)}else for(o=t.length-1;o>=0;--o){var s=t[o];if(!s)break;e.virtualElements.insertAfter(a,s,n)}return t},a.prototype.shouldDelayDeletion=function(e){return e&&("object"==typeof e||"function"==typeof e)},a.prototype.getPendingDeleteFor=function(e){var t=e&&e[f];return void 0===t?null:this.pendingDeletes[t]},a.prototype.getOrCreatePendingDeleteFor=function(e){var t=this.getPendingDeleteFor(e);return t?t:(t={data:e,nodesets:[]},e[f]=this.pendingDeletes.length,this.pendingDeletes.push(t),t)},a.prototype.deleted=function(e){if(this.shouldDelayDeletion(e.value)){var t=this.getOrCreatePendingDeleteFor(e.value);t.nodesets.push(this.getNodesForIndex(e.index))}else this.removeNodes(this.getNodesForIndex(e.index));this.indexesToDelete.push(e.index)},a.prototype.removeNodes=function(t){if(t.length){var n=function(){e.utils.arrayForEach(t,function(t){e.removeNode(t)})};if(this.beforeRemove){var i=this.beforeRemove({nodesToRemove:t,foreachInstance:this})||{};"function"==typeof i.then&&i.then(n,e.onError?e.onError:void 0)}else n()}},a.prototype.flushPendingDeletes=function(){for(var e=0,t=this.pendingDeletes.length;e!=t;++e){for(var n=this.pendingDeletes[e];n.nodesets.length;)this.removeNodes(n.nodesets.pop());n.data&&void 0!==n.data[f]&&delete n.data[f]}this.pendingDeletes=[]},a.prototype.clearDeletedIndexes=function(){for(var e=this.indexesToDelete.length-1;e>=0;--e)this.firstLastNodesList.splice(this.indexesToDelete[e],1);this.indexesToDelete=[]},a.prototype.getContextStartingFrom=function(t){for(var n;t;){if(n=e.contextFor(t))return n;t=t.nextSibling}},a.prototype.updateIndexes=function(e){for(var t,n=e,i=this.firstLastNodesList.length;i>n;++n)t=this.getContextStartingFrom(this.firstLastNodesList[n].first),t&&t.$index(n)},e.bindingHandlers.fastForEach={init:function(n,i,r,o,s){var u,l=i();return t(l)?(l.element=l.element||n,l.$context=s,u=new a(l)):u=new a({element:n,data:e.unwrap(s.$rawData)===l?s.$rawData:l,$context:s}),e.utils.domNodeDisposal.addDisposeCallback(n,function(){u.dispose()}),{controlsDescendantBindings:!0}},FastForEach:a},e.virtualElements.allowedBindings.fastForEach=!0}),define("svgUtil",[],function(){"use strict";return{getDimensions:function(e){return{width:e.width.baseVal.value,height:e.height.baseVal.value}},getDividerPath:function(e,t,n,i,r,o){var a=n,s=i,u=(r/e).toFixed(2),l=(o/t).toFixed(2),c=[];if(e>1){c.push("M "+a+" "+s);for(var d=1;d<e;d++)c.push("m "+u+" 0"),c.push("l 0 "+(d%2?o:-o))}if(t>1){c.push("M "+a+" "+s);for(var f=1;f<t;f++)c.push("m 0 "+l),c.push("l "+(f%2?r:-r)+" 0")}return c.length?c.join(" "):""}}}),define("AMD/knockout/koFaderHandleBinding",["knockout","jquery","util","svgUtil","AMD/Dimensions","AMD/VisualConfig"],function(e,t,n,i,r,o){"use strict";e.bindingHandlers.faderHandle={update:function(e,t,o,a,s){var u,l,c,d,f=r.getInstance().isLandscape(),p=t(),h=s.$data,g=h.props._centered,m=h.props._inverted,v=h.props._number,b=i.getDimensions(e.parentNode.parentNode),y=b.width,_=b.height,M="";p&&!n.isNumberInRange(v,2,1e4)||(h.isVertical?(u=.1*y,c=.8*y,d=.1*_,l=f?_*(g?.45:m?.85:.05):_*(g?.45:m?.05:.85),M=p&&i.getDividerPath(v,1,u,l,c,d)):(u=y*(g?.45:m?.85:.05),l=.1*_,d=.8*_,c=.1*y,M=p&&i.getDividerPath(1,v,u,l,c,d)),p?e.setAttribute("d",M):(e.setAttribute("x",u),e.setAttribute("y",l),e.setAttribute("width",c),e.setAttribute("height",d)))}}}),define("AMD/knockout/koSvgBindings",["knockout","util","svgUtil","LOG","AMD/Dimensions","AMD/LayoutHolder"],function(e,t,n,i,r,o){"use strict";var a=40,s=50,u=r.getInstance(),l=o.getInstance();e.bindingHandlers.svgRoot={update:function(e){var n=u.scaled();e.setAttribute("viewBox",t.formatString("0 0 {} {}",u.layoutWidth(),u.layoutHeight())),e.setAttribute("width",n.width),e.setAttribute("height",n.height),u.isLandscape()&&(e.style.transform=t.formatString("rotate(-90deg) translate(0, {}px)",-n.width))}},e.bindingHandlers.svgTabsArea={update:function(e){var t=(u.isLandscape()?u.layoutHeight():u.layoutWidth())-s;e.setAttribute("y",0),e.setAttribute("width",t),e.setAttribute("height",a)}},e.bindingHandlers.svgTabsAreaGroup={update:function(e){u.isLandscape()&&(e.style.transform=t.formatString("rotate(90deg) translate(0, {}px)",-u.layoutWidth()))}},e.bindingHandlers.svgTab={update:function(e,t,n,i,r){var o=l.tabPages().length,s=o&&r.$index();o&&"number"==typeof s&&(e.setAttribute("height",a),e.setAttribute("width",100/o+"%"),e.setAttribute("x",100/o*s+"%"))}},e.bindingHandlers.svgControlsArea={update:function(e){u.isLandscape()||e.setAttribute("transform",t.formatString("translate(0 {})",a))}},e.bindingHandlers.svgContainer={update:function(e){var t=u.isLandscape(),n=u.scaled();e.style.width=(t?n.height:n.width)+"px",e.style.height=(t?n.width:n.height)+"px"}},e.bindingHandlers.svgLabel={update:function(e,n,i,r,o){var a,s,l,c=r,d=u.isLandscape.peek(),f=c.isVertical,p=!d&&f||d&&f;p&&(a=$(e).closest(".svg__controlWrap")[0],t.assert(a,"Couldnt find parent .svg__controlWrap element for {}",e),s=a.width.baseVal.value,l=a.height.baseVal.value,e.setAttribute("transform",t.formatString("rotate(90,{},{})",s/2,l/2)))}},e.bindingHandlers.multiDivider={update:function(e,t,i,r,o){var a=r,s=a.props,u=n.getDimensions(e.parentNode.parentNode);e.setAttribute("d",n.getDividerPath(s._number_x,s._number_y,0,0,u.width,u.height))}}}),define("AMD/knockout/koLogContextBinding",["knockout","LOG"],function(e,t){"use strict";e.bindingHandlers.logContext={update:function(e,n,i,r,o){t.warn("Context for element %o -> %o",e,o)}}}),define("AMD/knockout/koDoubleClickBinding",["knockout","jquery","util"],function(e,t,n){"use strict";e.bindingHandlers.dblClick={init:function(i,r){var o=r();n.assertFunction(o,"Invalid handler for dblClick binding on element {}",i),t(i).on("dblclick",o),e.utils.domNodeDisposal.addDisposeCallback(i,function(){t(i).off("dblclick",o)})}}}),define("AMD/knockout/koRotaryHandleBinding",["knockout","util"],function(e,t){"use strict";e.bindingHandlers.rotaryHandle={update:function(e,n,i,r,o){var a,s=o.$data,u=!!n(),l=!s.isVertical,c=s.props._centered,d=s.props._inverted,f=s.props._w,p=Math.round(f/2),h=Math.round(.22*f),g=Math.round(.4*f),m=function(e,t){var n=Math.PI/180*e;return p+Math.cos(n)*t},v=function(e,t){var n=Math.PI/180*e;return p+Math.sin(n)*t};if(a=l?c?0:d?135:225:c?270:d?45:135,u){var b=g-h,y=(h+g)/2,_=(c?a+225:d?a+90:a)%360,M=(c?a+135:d?a:a+270)%360,x=m(_,y),E=v(_,y),A=m(M,y),D=v(M,y),C=t.formatString("M{},{} A{},{},0 1 1 {},{}",x,E,y,y,A,D);e.setAttribute("d",C),e.setAttribute("stroke-width",b)}else e.setAttribute("x1",m(a,h)),e.setAttribute("y1",v(a,h)),e.setAttribute("x2",m(a,g)),e.setAttribute("y2",v(a,g))}}}),define("lib/ko.svgTemplateEngine",["knockout"],function(e){"use strict";var t,n,i=new DOMParser;n=function(e){var t,n;return t=i.parseFromString('<svg xmlns="http://www.w3.org/2000/svg">'+e+"</svg>","image/svg+xml"),n=document.importNode(t.documentElement,!0)},e.templateSources.svgElement=function(e){this.element=e},e.templateSources.svgElement.prototype.nodes=function(){return n(this.element.text)},t=function(t){e.nativeTemplateEngine.prototype.constructor.call(this),this.templateSourceConstructor=t},t.prototype=new e.nativeTemplateEngine,t.prototype.constructor=t,t.prototype.makeTemplateSource=function(e,t){var n;if("string"==typeof e){if(t=t||document,n=t.getElementById(e),!n)throw new Error("Cannot find template with ID "+e);return new this.templateSourceConstructor(n)}throw new Error("Only named templates are supported")},e.svgTemplateEngine=function(){t.prototype.constructor.call(this,e.templateSources.svgElement)},e.svgTemplateEngine.prototype=new t,e.svgTemplateEngine.prototype.constructor=e.svgTemplateEngine,e.svgTemplateEngine.instance=new e.svgTemplateEngine}),define("AMD/knockout/koFocusAfterRender",["knockout"],function(e){"use strict";e.bindingHandlers.focusAfterRender={init:function(e,t){var n=t()||{select:!1};setTimeout(function(){e&&e.parentNode&&("function"==typeof e.focus&&e.focus(),n.select&&"function"==typeof e.select&&e.select())},50)}}}),define("AMD/knockout/koHighlightControlBinding",["knockout","underscore","jquery","util","AMD/edit/ControlEditor"],function(e,t,n,i,r){"use strict";var o="svg__selectable--highlight",a="td.controlEditor__highlighterCell",s="controlEditor__highlighterCell--active",u="highlight-timing",l=300,c=100,d=100,f=[],p={SINGLE_CONTROL:function(t){var i=e.dataFor(this),r=n("#svgSelectable_"+i.uid),a=n(t.target),c=a.data(u)||l;r.addClass(o),a.addClass(s),setTimeout(function(){r.removeClass(o),a.removeClass(s)},c)},ALL_CONTROLS:function(){t.each(f,clearTimeout),f=[],n(a).data(u,c).each(function(e){f.push(setTimeout(function(){var i=n(a).eq(e);i.length?i.trigger("click").data(u,null):t.each(f,clearTimeout)},e*d))})}},h={click:p.SINGLE_CONTROL},g={click:p.ALL_CONTROLS};r.getInstance().isHighlighterEnabled.subscribe(function(e){e&&setTimeout(p.ALL_CONTROLS,300)}),e.bindingHandlers.highlightControl={init:function(t,i){var r=n(t),o="ALL"===i(),a=o?g:h;r.on(a),e.utils.domNodeDisposal.addDisposeCallback(t,function(){n(t).off(a)})}}}),!function(e){"function"==typeof define&&define.amd?define("jquery-mousewheel",["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){function t(t){var a=t||window.event,s=u.call(arguments,1),l=0,d=0,f=0,p=0,h=0,g=0;if(t=e.event.fix(a),t.type="mousewheel","detail"in a&&(f=-1*a.detail),"wheelDelta"in a&&(f=a.wheelDelta),"wheelDeltaY"in a&&(f=a.wheelDeltaY),"wheelDeltaX"in a&&(d=-1*a.wheelDeltaX),"axis"in a&&a.axis===a.HORIZONTAL_AXIS&&(d=-1*f,f=0),l=0===f?d:f,"deltaY"in a&&(f=-1*a.deltaY,l=f),"deltaX"in a&&(d=a.deltaX,0===f&&(l=-1*d)),0!==f||0!==d){if(1===a.deltaMode){var m=e.data(this,"mousewheel-line-height");l*=m,f*=m,d*=m}else if(2===a.deltaMode){var v=e.data(this,"mousewheel-page-height");l*=v,f*=v,d*=v}if(p=Math.max(Math.abs(f),Math.abs(d)),(!o||o>p)&&(o=p,i(a,p)&&(o/=40)),i(a,p)&&(l/=40,d/=40,f/=40),l=Math[l>=1?"floor":"ceil"](l/o),d=Math[d>=1?"floor":"ceil"](d/o),f=Math[f>=1?"floor":"ceil"](f/o),c.settings.normalizeOffset&&this.getBoundingClientRect){var b=this.getBoundingClientRect();h=t.clientX-b.left,g=t.clientY-b.top}return t.deltaX=d,t.deltaY=f,t.deltaFactor=o,t.offsetX=h,t.offsetY=g,t.deltaMode=0,s.unshift(t,l,d,f),r&&clearTimeout(r),r=setTimeout(n,200),(e.event.dispatch||e.event.handle).apply(this,s)}}function n(){o=null}function i(e,t){return c.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120===0}var r,o,a=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],s="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],u=Array.prototype.slice;if(e.event.fixHooks)for(var l=a.length;l;)e.event.fixHooks[a[--l]]=e.event.mouseHooks;var c=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var n=s.length;n;)this.addEventListener(s[--n],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",c.getLineHeight(this)),e.data(this,"mousewheel-page-height",c.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var n=s.length;n;)this.removeEventListener(s[--n],t,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var n=e(t),i=n["offsetParent"in e.fn?"offsetParent":"parent"]();return i.length||(i=e("body")),parseInt(i.css("fontSize"),10)||parseInt(n.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),define("AMD/knockout/koCountByArrowUpDownBinding",["knockout","jquery","jquery-mousewheel"],function(e,t){"use strict";var n=/^-?[0-9]+?$/,i=38,r=40,o=function(e){var o=e.target.value,a=n.test(""+o)?parseInt(o):null,s=e.keyCode,u=e.deltaY||0,l=s===i||u>0,c=s===r||u<0;!l&&!c||isNaN(a)||(a+=l?1:c?-1:0,e.preventDefault(),t(e.target).val(a).trigger("change"))};e.bindingHandlers.countByArrowUpDown={init:function(n,i){t(n).on("keydown mousewheel",o),e.utils.domNodeDisposal.addDisposeCallback(n,function(){t(n).off("keydown mousewheel",o)})}}}),define("AMD/QuickEditApp",["knockout","underscore","jquery","util","LOG","zip","AMD/file/JsonXmlConverter","AMD/VisualMode","AMD/ControlFilter","AMD/edit/ControlEditor","AMD/Dimensions","AMD/LayoutHolder","AMD/midi/MidiUtil","AMD/EncodingCheck","AMD/file/SourceFileHolder","AMD/file/JsonSanitizer","AMD/ControlSelection","koToggleableExtender","knockoutFastForeach","AMD/knockout/koFaderHandleBinding","AMD/knockout/koSvgBindings","AMD/knockout/koLogContextBinding","AMD/knockout/koDoubleClickBinding","AMD/knockout/koRotaryHandleBinding","lib/ko.svgTemplateEngine","AMD/knockout/koFocusAfterRender","AMD/knockout/koHighlightControlBinding","AMD/knockout/koCountByArrowUpDownBinding"],function(e,t,n,i,r,o,a,s,u,l,c,d,f,p,h,g,m){"use strict";function v(){var g=this,v=0,y=e.observable(),_=a.getInstance(),M=function(){var t=++v,n=e.computed({read:e.computed(function(){return y()===t}),write:function(){y(t)}});return n.MODE_ID=t,n};this.midiUtil=f,this.layoutHolder=d.getInstance(),this.sourceFileHolder=h.getInstance(),this.exportFilename=e.observable(),this.sourceFileHolder.sanitizedJson.subscribe(g.layoutHolder.json),this.dimensions=c.getInstance(),this.visual=new s,this.controlFilter=u.getInstance(),this.controlSelection=m.getInstance(),this.controlEditor=l.getInstance(),this.infoMode=M(),this.detailsMode=M(),this.visualMode=M(),this.exportMode=M(),this.jsonMode=M(),this.sourceXmlMode=M(),this.targetXmlMode=M(),this.tableMode=M(),this.encodingCheckMode=M(),this.isDevModeEnabled=e.observable(!1).extend({toggleable:!0});var x=[g.visualMode,g.tableMode];y.subscribe(function(e){var n=t.some(x,function(t){return t.MODE_ID===e}),i=n;g.controlFilter.isVisible(n),g.controlEditor.isVisible(i)}),this.error=e.observable(),this.sourceFileHolder.error.subscribe(this.error),this.exportUrl=e.observable(),this.encodingCheck=p.getInstance(),this.getXmlForExport=function(){var e=g.layoutHolder.getJsonForExport();return e?_.json2xml(e):""},this.startExport=function(){g.exportUrl(""),o.createWriter(new o.BlobWriter,function(e){e.add("index.xml",new o.TextReader(g.getXmlForExport()),function(){e.close(function(e){var i=b.createObjectURL(e);g.exportUrl(i),r.dev("blobUrl created: "+i),t.defer(function(){n("#hiddenExportLink")[0].click()})})},function(e,t){})},function(e){g.error("Error while zipping"),r.error(e)})},this.sourceFileHolder.file.subscribe(function(e){g.encodingCheckMode(!0),g.exportFilename(e?e.replace(/.+?([^\/\\]+)(.touchosc)$/,"$1--modified$2"):""),g.controlSelection.reset(),g.controlFilter.reset()}),this.gotoTabPage=function(e){g.visual.currentTabPage(e),g.visualMode(!0)},e.computed(function(){var e={},n=g.layoutHolder.json(),i=n&&n.layout&&n.layout.tabpage,r=i&&(g.visualMode()?[g.visual.currentTabPage()]:g.tableMode()?i:null);r&&(t.each(r,function(n){t.each(n&&n.control,function(t){var n=t.BASE_TYPE_NAME;e[n]=(e[n]||0)+1})}),g.controlFilter.updateCounts(e))}),this.loadDemo=function(){n.ajax({url:"resources/demo/demo.xml",method:"get",dataType:"text",success:function(e){g.sourceFileHolder.xml(e),g.exportFilename("demo-modified.touchosc"),t.defer(function(){g.controlSelection.reset(),g.controlFilter.reset(),g.visualMode(!0)})}})},this.setGlobalChannel=function(e){i.assertNumberInRange(e,1,16,"Invalid channel for setGlobalChannel: {}",e),confirm("Set channel "+e+" on all controls?")&&(g.layoutHolder.forEachControl(function(n){t.each(n.props.midi,function(t){var n=f.MessageTypes.byId[t._type];n&&!n.hasFixChannel&&"undefined"!=typeof t._channel&&(t._channel=e)})}),g.layoutHolder.triggerRedraw())},this.prettyTimecode=function(e){i.assertNumber(e,"Invalid timecode for prettyTimecode()");var t=new Date(e),n=t.toLocaleDateString&&t.toLocaleDateString()||"",r=t.toLocaleTimeString&&t.toLocaleTimeString()||t.toString();return n+" "+r},this.infoMode(!0);
}var b=window.URL||window.webkitURL||window.mozURL;return{init:function(){e.applyBindings(new v)}}}),define("AMD/util/Draggable",["jquery"],function(e){"use strict";return{init:function(t){var n=e(t).data("handleSelector");e(t).draggable({handle:n,distance:3})}}});